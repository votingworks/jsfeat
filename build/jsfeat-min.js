!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(t=t||self).jsfeat=r()}(this,(function(){"use strict";var t,r,a={REVISION:"ALPHA"},e=function(){function t(t){this.next=null,this.data=new a.data_t(t),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64}return t.prototype.resize=function(t){delete this.data,this.data=new a.data_t(t),this.size=this.data.size,this.buffer=this.data.buffer,this.u8=this.data.u8,this.i32=this.data.i32,this.f32=this.data.f32,this.f64=this.data.f64},t}();const o=function(r){var a=t;return t=t.next,r>a.size&&a.resize(r),a},i=function(t){r=r.next=t};!function(a,o){t=r=new e(o);for(var i=0;i<a;++i){var f=new e(o);r=r.next=f}}(30,2560);var f=new Int32Array(96);const n=function(t,r,e,f){var n=0,s=0,h=0,d=0,c=0,u=0,l=o(t<<2),v=l.f32;if(1==(1&t)&&t<=7&&r<=0)switch(t>>1){case 0:v[0]=1,u=1;break;case 1:v[0]=.25,v[1]=.5,v[2]=.25,u=1;break;case 2:v[0]=.0625,v[1]=.25,v[2]=.375,v[3]=.25,v[4]=.0625,u=1;break;case 3:v[0]=.03125,v[1]=.109375,v[2]=.21875,v[3]=.28125,v[4]=.21875,v[5]=.109375,v[6]=.03125,u=1}else for(c=-.5/((d=r>0?r:.3*(.5*(t-1)-1)+.8)*d);n<t;++n)s=n-.5*(t-1),h=Math.exp(c*s*s),v[n]=h,u+=h;if(f&a.U8_t)for(u=256/u,n=0;n<t;++n)e[n]=v[n]*u+.5|0;else for(u=1/u,n=0;n<t;++n)e[n]=v[n]*u;i(l)},s=function(t,r,a){for(var e,o=0,i=0,f=0,n=r+a>>1;;){if(a<=r)return t[n];if(a==r+1)return t[r]>t[a]&&(e=t[r],t[r]=t[a],t[a]=e),t[n];for(t[o=r+a>>1]>t[a]&&(e=t[o],t[o]=t[a],t[a]=e),t[r]>t[a]&&(e=t[r],t[r]=t[a],t[a]=e),t[o]>t[r]&&(e=t[o],t[o]=t[r],t[r]=e),i=r+1,e=t[o],t[o]=t[i],t[i]=e,f=a;;){do{++i}while(t[r]>t[i]);do{--f}while(t[f]>t[r]);if(f<i)break;e=t[i],t[i]=t[f],t[f]=e}e=t[r],t[r]=t[f],t[f]=e,f<=n?r=i:f>=n&&(a=f-1)}};var h=Object.freeze({__proto__:null,get_gaussian_kernel:n,perspective_4point_transform:function(t,r,a,e,o,i,f,n,s,h,d,c,u,l,v,_,p){var y=r,x=h,m=f,w=y*x*m,b=v,M=y*b,g=x*M,k=d,z=y*k,A=i,C=a,O=l,R=C*O,S=R*A,L=O*A*k,I=O*m,U=O*k,q=x*m,G=b*x,F=b*A,B=k*A,N=1/(I-U-q+G-F+B),E=y*O,P=C*A,V=m*y,j=b*V,T=C*x,Y=R*k,D=C*k*A,Q=m*b*x,X=b*C,H=-(g-w+z*A-A*M-R*x+S-L+I*x)*N,J=(w-g-E*m+E*k+S-x*P+F*x-L)*N,K=y,W=(-k*M+j+T*m-R*m+Y-D+F*k-Q)*N,Z=(V*k-j-X*x+Y-D+X*A+Q-I*k)*N,$=C,tt=(-z+V+T-P+U-I-G+F)*N,rt=(-M+z+R-T+F-B-I+q)*N,at=-((g=(x=c)*(M=(y=e)*(b=p)))-(w=y*x*(m=s))+(z=y*(k=u))*(A=n)-A*M-(R=(C=o)*(O=_))*x+(S=R*A)-(L=O*A*k)+(I=O*m)*x)*(N=1/(I-(U=O*k)-(q=x*m)+(G=b*x)-(F=b*A)+(B=k*A))),et=(w-g-(E=y*O)*m+E*k+S-x*(P=C*A)+F*x-L)*N,ot=y,it=(-k*M+(j=b*(V=m*y))+(T=C*x)*m-R*m+(Y=R*k)-(D=C*k*A)+F*k-(Q=m*b*x))*N,ft=(V*k-j-(X=b*C)*x+Y-D+X*A+Q-I*k)*N,nt=C,st=(-z+V+T-P+U-I-G+F)*N,ht=(-M+z+R-T+F-B-I+q)*N,dt=K*tt;S=$*tt-W;var ct=-W*rt+Z*tt,ut=H-dt;P=H*rt-(z=J*tt);var lt=(w=H*$)-(g=K*W),vt=(m=H*Z)-(M=W*J);D=(x=Z-rt*$)*(O=1/(m-w*rt-M+g*rt+z*$-dt*Z));var _t=(B=K*rt-J)*O,pt=(V=-J*$+K*Z)*O,yt=t.data;yt[0]=at*D+et*(S*O)-ot*(ct*O),yt[1]=at*_t+et*(ut*O)-ot*(P*O),yt[2]=-at*pt-et*(lt*O)+ot*(vt*O),yt[3]=it*D+ft*(S*O)-nt*(ct*O),yt[4]=it*_t+ft*(ut*O)-nt*(P*O),yt[5]=-it*pt-ft*(lt*O)+nt*(vt*O),yt[6]=st*D+ht*(S*O)-ct*O,yt[7]=st*_t+ht*(ut*O)-P*O,yt[8]=-st*pt-ht*(lt*O)+vt*O},qsort:function(t,r,a,e){var o,i,n,s,h=0,d=0,c=0,u=0,l=0,v=0,_=0,p=0,y=0,x=0,m=0,w=0,b=0,M=0,g=0,k=0,z=0,A=0,C=f;if(!(a-r+1<=1))for(C[0]=r,C[1]=a;h>=0;)for(d=C[h<<1],c=C[1+(h<<1)],h--;;){if((l=c-d+1)<=7){for(_=d+1;_<=c;_++)for(p=_;p>d&&e(t[p],t[p-1]);p--)o=t[p],t[p]=t[p-1],t[p-1]=o;break}for(A=0,x=d,w=c,M=d+(l>>1),l>40&&(k=d+(y=l>>3),z=d+(y<<1),i=t[g=d],n=t[k],s=t[z],d=e(i,n)?e(n,s)?k:e(i,s)?z:g:e(s,n)?k:e(i,s)?g:z,k=M,z=M+y,i=t[g=M-y],n=t[k],s=t[z],M=e(i,n)?e(n,s)?k:e(i,s)?z:g:e(s,n)?k:e(i,s)?g:z,k=c-y,z=c,i=t[g=c-(y<<1)],n=t[k],s=t[z],c=e(i,n)?e(n,s)?k:e(i,s)?z:g:e(s,n)?k:e(i,s)?g:z),k=M,z=c,i=t[g=d],n=t[k],s=t[z],(M=e(i,n)?e(n,s)?k:e(i,s)?z:g:e(s,n)?k:e(i,s)?g:z)!=x&&(o=t[M],t[M]=t[x],t[x]=o,M=x),d=m=x+1,c=b=w,i=t[M];;){for(;d<=c&&!e(i,t[d]);)e(t[d],i)||(d>m&&(o=t[m],t[m]=t[d],t[d]=o),A=1,m++),d++;for(;d<=c&&!e(t[c],i);)e(i,t[c])||(c<b&&(o=t[b],t[b]=t[c],t[c]=o),A=1,b--),c--;if(d>c)break;o=t[d],t[d]=t[c],t[c]=o,A=1,d++,c--}if(0==A){for(c=w,_=(d=x)+1;_<=c;_++)for(p=_;p>d&&e(t[p],t[p-1]);p--)o=t[p],t[p]=t[p-1],t[p-1]=o;break}for(v=d-(l=Math.min(m-x,d-m))|0,u=0;u<l;++u,++v)o=t[x+u],t[x+u]=t[v],t[v]=o;for(v=w-(l=Math.min(w-b,b-c))+1|0,u=0;u<l;++u,++v)o=t[d+u],t[d+u]=t[v],t[v]=o;if(v=b-c,(l=d-m)>1)v>1?l>v?(C[++h<<1]=x,C[1+(h<<1)]=x+l-1,d=w-v+1,c=w):(C[++h<<1]=w-v+1,C[1+(h<<1)]=w,d=x,c=x+l-1):(d=x,c=x+l-1);else{if(!(v>1))break;d=w-v+1,c=w}}},median:s});const d=function(t,r,e,f){var n=t.rows,s=t.cols;n>f&&s>e&&(r.resize(e,f,t.channel),t.type&a.U8_t&&r.type&a.U8_t&&n*s/(f*e)<256?function(t,r,a,e){for(var f=0,n=t.channel,s=t.cols,h=t.rows,d=t.data,c=r.data,u=s/a,l=h/e,v=u*l*65536|0,_=0,p=0,y=0,x=0,m=0,w=0,b=0,M=0,g=0,k=0,z=0,A=0,C=0,O=0,R=0,S=0,L=o(a*n<<2),I=o(a*n<<2),U=o(2*s*3<<2),q=L.i32,G=I.i32,F=U.i32;_<a;_++){for(m=(g=_*u)+1-1e-6|0,w=0|(k=g+u),m=Math.min(m,s-1),w=Math.min(w,s-1),m>g&&(F[M++]=_*n|0,F[M++]=(m-1)*n|0,F[M++]=256*(m-g)|0,f++),y=m;y<w;y++)f++,F[M++]=_*n|0,F[M++]=y*n|0,F[M++]=256;k-w>.001&&(f++,F[M++]=_*n|0,F[M++]=w*n|0,F[M++]=256*(k-w)|0)}for(_=0;_<a*n;_++)q[_]=G[_]=0;for(p=0,x=0;x<h;x++){for(z=s*x,M=0;M<f;M++)for(C=F[3*M],m=F[3*M+1],O=F[3*M+2],b=0;b<n;b++)q[C+b]+=d[z+m+b]*O;if((p+1)*l<=x+1||x==h-1){if(S=256-(R=256*Math.max(x+1-(p+1)*l,0)|0),A=a*p,R<=0)for(_=0;_<a*n;_++)c[A+_]=Math.min(Math.max((G[_]+256*q[_])/v,0),255),G[_]=q[_]=0;else for(_=0;_<a*n;_++)c[A+_]=Math.min(Math.max((G[_]+q[_]*S)/v,0),255),G[_]=q[_]*R,q[_]=0;p++}else for(_=0;_<a*n;_++)G[_]+=256*q[_],q[_]=0}i(I),i(L),i(U)}(t,r,e,f):function(t,r,a,e){for(var f=0,n=t.channel,s=t.cols,h=t.rows,d=t.data,c=r.data,u=s/a,l=h/e,v=1/(u*l),_=0,p=0,y=0,x=0,m=0,w=0,b=0,M=0,g=0,k=0,z=0,A=0,C=0,O=0,R=0,S=0,L=o(a*n<<2),I=o(a*n<<2),U=o(2*s*3<<2),q=L.f32,G=I.f32,F=U.f32;_<a;_++){for(m=(g=_*u)+1-1e-6|0,w=0|(k=g+u),m=Math.min(m,s-1),w=Math.min(w,s-1),m>g&&(f++,F[M++]=(m-1)*n|0,F[M++]=_*n|0,F[M++]=(m-g)*v),y=m;y<w;y++)f++,F[M++]=y*n|0,F[M++]=_*n|0,F[M++]=v;k-w>.001&&(f++,F[M++]=w*n|0,F[M++]=_*n|0,F[M++]=(k-w)*v)}for(_=0;_<a*n;_++)q[_]=G[_]=0;for(p=0,x=0;x<h;x++){for(z=s*x,M=0;M<f;M++)for(m=0|F[3*M],C=0|F[3*M+1],O=F[3*M+2],b=0;b<n;b++)q[C+b]+=d[z+m+b]*O;if((p+1)*l<=x+1||x==h-1){if(S=1-(R=Math.max(x+1-(p+1)*l,0)),A=a*p,Math.abs(R)<.001)for(_=0;_<a*n;_++)c[A+_]=G[_]+q[_],G[_]=q[_]=0;else for(_=0;_<a*n;_++)c[A+_]=G[_]+q[_]*S,G[_]=q[_]*R,q[_]=0;p++}else for(_=0;_<a*n;_++)G[_]+=q[_],q[_]=0}i(I),i(L),i(U)}(t,r,e,f))},c=function(t,r,a,e){void 0===a&&(a=0),void 0===e&&(e=0);var o=t.cols,i=o>>1,f=t.rows>>1,n=i-(a<<1),s=f-(e<<1),h=0,d=0,c=a+e*o,u=0,l=0,v=0;r.resize(i,f,t.channel);var _=t.data,p=r.data;for(d=0;d<s;++d){for(u=c,v=l,h=0;h<=n-2;h+=2,v+=2,u+=4)p[v]=_[u]+_[u+1]+_[u+o]+_[u+o+1]+2>>2,p[v+1]=_[u+2]+_[u+3]+_[u+o+2]+_[u+o+3]+2>>2;for(;h<n;++h,++v,u+=2)p[v]=_[u]+_[u+1]+_[u+o]+_[u+o+1]+2>>2;c+=o<<1,l+=i}},u=function(t,r){var e,f,n,s,h,d,c,u,l=t.cols,v=t.rows,_=l<<1,p=0,y=0,x=0,m=0,w=0,b=0,M=0;r.resize(l,v,2);var g=t.data,k=r.data,z=o(l+2<<2),A=o(l+2<<2);for(t.type&a.U8_t||t.type&a.S32_t?(c=z.i32,u=A.i32):(c=z.f32,u=A.f32);y<v;++y,w+=l){for(m=(y>0?y-1:1)*l|0,b=(y<v-1?y+1:v-2)*l|0,M=y*_|0,p=0,x=1;p<=l-2;p+=2,x+=2)e=g[m+p],f=g[b+p],c[x]=3*(e+f)+10*g[w+p],u[x]=f-e,e=g[m+p+1],f=g[b+p+1],c[x+1]=3*(e+f)+10*g[w+p+1],u[x+1]=f-e;for(;p<l;++p,++x)e=g[m+p],f=g[b+p],c[x]=3*(e+f)+10*g[w+p],u[x]=f-e;for(p=l+1|0,c[0]=c[1],c[p]=c[l],u[0]=u[1],u[p]=u[l],p=0;p<=l-4;p+=4)e=u[p+2],f=u[p+1],n=u[p+3],s=u[p+4],h=c[p+2],d=c[p+3],k[M++]=h-c[p],k[M++]=3*(e+u[p])+10*f,k[M++]=d-c[p+1],k[M++]=3*(n+f)+10*e,k[M++]=c[p+4]-h,k[M++]=3*(s+e)+10*n,k[M++]=c[p+5]-d,k[M++]=3*(u[p+5]+n)+10*s;for(;p<l;++p)k[M++]=c[p+2]-c[p],k[M++]=3*(u[p+2]+u[p])+10*u[p+1]}i(z),i(A)},l=function(t,r){var e,f,n,s,h,d,c,u,l=t.cols,v=t.rows,_=l<<1,p=0,y=0,x=0,m=0,w=0,b=0,M=0;r.resize(l,v,2);var g=t.data,k=r.data,z=o(l+2<<2),A=o(l+2<<2);for(t.type&a.U8_t||t.type&a.S32_t?(c=z.i32,u=A.i32):(c=z.f32,u=A.f32);y<v;++y,w+=l){for(m=(y>0?y-1:1)*l|0,b=(y<v-1?y+1:v-2)*l|0,M=y*_|0,p=0,x=1;p<=l-2;p+=2,x+=2)e=g[m+p],f=g[b+p],c[x]=e+f+2*g[w+p],u[x]=f-e,e=g[m+p+1],f=g[b+p+1],c[x+1]=e+f+2*g[w+p+1],u[x+1]=f-e;for(;p<l;++p,++x)e=g[m+p],f=g[b+p],c[x]=e+f+2*g[w+p],u[x]=f-e;for(p=l+1|0,c[0]=c[1],c[p]=c[l],u[0]=u[1],u[p]=u[l],p=0;p<=l-4;p+=4)e=u[p+2],f=u[p+1],n=u[p+3],s=u[p+4],h=c[p+2],d=c[p+3],k[M++]=h-c[p],k[M++]=e+u[p]+2*f,k[M++]=d-c[p+1],k[M++]=n+f+2*e,k[M++]=c[p+4]-h,k[M++]=s+e+2*n,k[M++]=c[p+5]-d,k[M++]=u[p+5]+n+2*s;for(;p<l;++p)k[M++]=c[p+2]-c[p],k[M++]=u[p+2]+u[p]+2*u[p+1]}i(z),i(A)},v=function(t,r,a,e){void 0===e&&(e=0);for(var o=t.cols,i=t.rows,f=r.cols,n=r.rows,s=t.data,h=r.data,d=0,c=0,u=0,l=0,v=0,_=0,p=0,y=0,x=0,m=0,w=0,b=a.data,M=b[0],g=b[1],k=b[2],z=b[3],A=b[4],C=b[5],O=0;c<n;++c)for(_=g*c+k,p=A*c+C,d=0;d<f;++d,++O,_+=M,p+=z)v=0|p,(l=0|_)>=0&&v>=0&&l<o-1&&v<i-1?(y=_-l,x=p-v,m=s[u=o*v+l]+y*(s[u+1]-s[u]),w=s[u+o]+y*(s[u+o+1]-s[u+o]),h[O]=m+x*(w-m)):h[O]=e};var _,p,y,x,m,w,b,M,g,k=Object.freeze({__proto__:null,grayscale:function(t,r,e,o,i){void 0===i&&(i=a.COLOR_RGBA2GRAY);var f=0,n=0,s=0,h=0,d=0,c=0,u=4899,l=1868,v=4;i!=a.COLOR_BGRA2GRAY&&i!=a.COLOR_BGR2GRAY||(u=1868,l=4899),i!=a.COLOR_RGB2GRAY&&i!=a.COLOR_BGR2GRAY||(v=3);var _=v<<1,p=3*v|0;o.resize(r,e,1);var y=o.data;for(n=0;n<e;++n,h+=r,s+=r*v){for(f=0,d=s,c=h;f<=r-4;f+=4,d+=v<<2,c+=4)y[c]=t[d]*u+9617*t[d+1]+t[d+2]*l+8192>>14,y[c+1]=t[d+v]*u+9617*t[d+v+1]+t[d+v+2]*l+8192>>14,y[c+2]=t[d+_]*u+9617*t[d+_+1]+t[d+_+2]*l+8192>>14,y[c+3]=t[d+p]*u+9617*t[d+p+1]+t[d+p+2]*l+8192>>14;for(;f<r;++f,++c,d+=v)y[c]=t[d]*u+9617*t[d+1]+t[d+2]*l+8192>>14}},resample:d,box_blur_gray:function(t,r,e,f){void 0===f&&(f=0);var n=t.cols,s=t.rows,h=s<<1,d=n<<1,c=0,u=0,l=0,v=0,_=1+(e<<1)|0,p=e+1|0,y=p+1|0,x=f&a.BOX_BLUR_NOSCALE?1:1/(_*_),m=o(n*s<<2),w=0,b=0,M=0,g=0,k=0,z=m.i32,A=t.data,C=0;for(r.resize(n,s,t.channel),l=0;l<s;++l){for(b=l,w=p*A[M],c=M+1|0,v=M+e|0;c<=v;++c)w+=A[c];for(g=M+p|0,C=A[k=M],u=0;u<e;++u,b+=s)z[b]=w,w+=A[g]-C,g++;for(;u<n-y;u+=2,b+=h)z[b]=w,w+=A[g]-A[k],z[b+s]=w,w+=A[g+1]-A[k+1],g+=2,k+=2;for(;u<n-p;++u,b+=s)z[b]=w,w+=A[g]-A[k],g++,k++;for(C=A[g-1];u<n;++u,b+=s)z[b]=w,w+=C-A[k],k++;M+=n}if(M=0,A=r.data,1==x)for(l=0;l<n;++l){for(b=l,w=p*z[M],c=M+1|0,v=M+e|0;c<=v;++c)w+=z[c];for(g=M+p,C=z[k=M],u=0;u<e;++u,b+=n)A[b]=w,w+=z[g]-C,g++;for(;u<s-y;u+=2,b+=d)A[b]=w,w+=z[g]-z[k],A[b+n]=w,w+=z[g+1]-z[k+1],g+=2,k+=2;for(;u<s-p;++u,b+=n)A[b]=w,w+=z[g]-z[k],g++,k++;for(C=z[g-1];u<s;++u,b+=n)A[b]=w,w+=C-z[k],k++;M+=s}else for(l=0;l<n;++l){for(b=l,w=p*z[M],c=M+1|0,v=M+e|0;c<=v;++c)w+=z[c];for(g=M+p,C=z[k=M],u=0;u<e;++u,b+=n)A[b]=w*x,w+=z[g]-C,g++;for(;u<s-y;u+=2,b+=d)A[b]=w*x,w+=z[g]-z[k],A[b+n]=w*x,w+=z[g+1]-z[k+1],g+=2,k+=2;for(;u<s-p;++u,b+=n)A[b]=w*x,w+=z[g]-z[k],g++,k++;for(C=z[g-1];u<s;++u,b+=n)A[b]=w*x,w+=C-z[k],k++;M+=s}i(m)},gaussian_blur:function(t,r,e,f){void 0===f&&(f=0),void 0===e&&(e=0);var s=(e=0==e?2*Math.max(1,4*f+1-1e-8)+1|0:e)>>1,h=t.cols,d=t.rows,c=t.type,u=c&a.U8_t;r.resize(h,d,t.channel);var l,v,_=t.data,p=r.data,y=e+Math.max(d,h)|0,x=o(y<<2),m=o(e<<2);u?(l=x.i32,v=m.i32):c&a.S32_t?(l=x.i32,v=m.f32):(l=x.f32,v=m.f32),n(e,f,v,c),u?function(t,r,a,e,o,i,f,n){for(var s=0,h=0,d=0,c=0,u=0,l=0,v=0,_=0,p=0,y=i[0],x=0,m=e<<1,w=3*e,b=e<<2;s<o;++s){for(l=r[c],h=0;h<n;++h)t[h]=l;for(h=0;h<=e-2;h+=2)t[h+n]=r[c+h],t[h+n+1]=r[c+h+1];for(;h<e;++h)t[h+n]=r[c+h];for(l=r[c+e-1],h=e;h<n+e;++h)t[h+n]=l;for(h=0;h<=e-4;h+=4){for(l=t[h]*y,v=t[h+1]*y,_=t[h+2]*y,p=t[h+3]*y,d=1;d<f;++d)x=i[d],l+=t[d+h]*x,v+=t[d+h+1]*x,_+=t[d+h+2]*x,p+=t[d+h+3]*x;a[u+h]=Math.min(l>>8,255),a[u+h+1]=Math.min(v>>8,255),a[u+h+2]=Math.min(_>>8,255),a[u+h+3]=Math.min(p>>8,255)}for(;h<e;++h){for(l=t[h]*y,d=1;d<f;++d)l+=t[d+h]*i[d];a[u+h]=Math.min(l>>8,255)}c+=e,u+=e}for(s=0;s<e;++s){for(l=a[s],h=0;h<n;++h)t[h]=l;for(d=s,h=0;h<=o-2;h+=2,d+=m)t[h+n]=a[d],t[h+n+1]=a[d+e];for(;h<o;++h,d+=e)t[h+n]=a[d];for(l=a[(o-1)*e+s],h=o;h<n+o;++h)t[h+n]=l;for(u=s,h=0;h<=o-4;h+=4,u+=b){for(l=t[h]*y,v=t[h+1]*y,_=t[h+2]*y,p=t[h+3]*y,d=1;d<f;++d)x=i[d],l+=t[d+h]*x,v+=t[d+h+1]*x,_+=t[d+h+2]*x,p+=t[d+h+3]*x;a[u]=Math.min(l>>8,255),a[u+e]=Math.min(v>>8,255),a[u+m]=Math.min(_>>8,255),a[u+w]=Math.min(p>>8,255)}for(;h<o;++h,u+=e){for(l=t[h]*y,d=1;d<f;++d)l+=t[d+h]*i[d];a[u]=Math.min(l>>8,255)}}}(l,_,p,h,d,v,e,s):function(t,r,a,e,o,i,f,n){for(var s=0,h=0,d=0,c=0,u=0,l=0,v=0,_=0,p=0,y=i[0],x=0,m=e<<1,w=3*e,b=e<<2;s<o;++s){for(l=r[c],h=0;h<n;++h)t[h]=l;for(h=0;h<=e-2;h+=2)t[h+n]=r[c+h],t[h+n+1]=r[c+h+1];for(;h<e;++h)t[h+n]=r[c+h];for(l=r[c+e-1],h=e;h<n+e;++h)t[h+n]=l;for(h=0;h<=e-4;h+=4){for(l=t[h]*y,v=t[h+1]*y,_=t[h+2]*y,p=t[h+3]*y,d=1;d<f;++d)x=i[d],l+=t[d+h]*x,v+=t[d+h+1]*x,_+=t[d+h+2]*x,p+=t[d+h+3]*x;a[u+h]=l,a[u+h+1]=v,a[u+h+2]=_,a[u+h+3]=p}for(;h<e;++h){for(l=t[h]*y,d=1;d<f;++d)l+=t[d+h]*i[d];a[u+h]=l}c+=e,u+=e}for(s=0;s<e;++s){for(l=a[s],h=0;h<n;++h)t[h]=l;for(d=s,h=0;h<=o-2;h+=2,d+=m)t[h+n]=a[d],t[h+n+1]=a[d+e];for(;h<o;++h,d+=e)t[h+n]=a[d];for(l=a[(o-1)*e+s],h=o;h<n+o;++h)t[h+n]=l;for(u=s,h=0;h<=o-4;h+=4,u+=b){for(l=t[h]*y,v=t[h+1]*y,_=t[h+2]*y,p=t[h+3]*y,d=1;d<f;++d)x=i[d],l+=t[d+h]*x,v+=t[d+h+1]*x,_+=t[d+h+2]*x,p+=t[d+h+3]*x;a[u]=l,a[u+e]=v,a[u+m]=_,a[u+w]=p}for(;h<o;++h,u+=e){for(l=t[h]*y,d=1;d<f;++d)l+=t[d+h]*i[d];a[u]=l}}}(l,_,p,h,d,v,e,s),i(x),i(m)},hough_transform:function(t,r,a,e){for(var o=t.data,i=t.cols,f=t.rows,n=i,s=Math.PI,h=Math.round((s-0)/a),d=Math.round((2*(i+f)+1)/r),c=1/r,u=new Int32Array((h+2)*(d+2)),l=new Float32Array(h),v=new Float32Array(h),_=0,p=0;_<h;_++)l[_]=Math.sin(p)*c,v[_]=Math.cos(p)*c,p+=a;for(var y=0;y<f;y++)for(var x=0;x<i;x++)if(0!=o[y*n+x])for(let t=0;t<h;t++){var m=Math.round(x*v[t]+y*l[t]);u[(t+1)*(d+2)+(m+=(d-1)/2)+1]+=1}var w=new Array;for(let t=0;t<d;t++)for(let r=0;r<h;r++){var b=(r+1)*(d+2)+t+1;u[b]>e&&u[b]>u[b-1]&&u[b]>=u[b+1]&&u[b]>u[b-d-2]&&u[b]>=u[b+d+2]&&w.push(b)}w.sort((function(t,r){return u[t]>u[r]||u[t]==u[r]&&t<r}));var M=Math.min(h*d,w.length),g=1/(d+2),k=new Array;for(let t=0;t<M;t++){var z=w[t];let e=Math.floor(z*g)-1;var A=(z-(e+1)*(d+2)-1-.5*(d-1))*r,C=e*a;k.push([A,C])}return k},pyrdown:c,scharr_derivatives:u,sobel_derivatives:l,compute_integral_image:function(t,r,a,e){var o=0|t.cols,i=0|t.rows,f=t.data,n=o+1|0,s=0,h=0,d=0,c=0,u=0,l=0,v=0,_=0;if(r&&a){for(;u<n;++u)r[u]=0,a[u]=0;for(d=n+1|0,c=1,u=0,_=0;u<i;++u,++d,++c){for(s=h=0,l=0;l<=o-2;l+=2,_+=2,d+=2,c+=2)s+=v=f[_],h+=v*v,r[d]=r[c]+s,a[d]=a[c]+h,s+=v=f[_+1],h+=v*v,r[d+1]=r[c+1]+s,a[d+1]=a[c+1]+h;for(;l<o;++l,++_,++d,++c)s+=v=f[_],h+=v*v,r[d]=r[c]+s,a[d]=a[c]+h}}else if(r){for(;u<n;++u)r[u]=0;for(d=n+1|0,c=1,u=0,_=0;u<i;++u,++d,++c){for(s=0,l=0;l<=o-2;l+=2,_+=2,d+=2,c+=2)s+=f[_],r[d]=r[c]+s,s+=f[_+1],r[d+1]=r[c+1]+s;for(;l<o;++l,++_,++d,++c)s+=f[_],r[d]=r[c]+s}}else if(a){for(;u<n;++u)a[u]=0;for(d=n+1|0,c=1,u=0,_=0;u<i;++u,++d,++c){for(h=0,l=0;l<=o-2;l+=2,_+=2,d+=2,c+=2)h+=(v=f[_])*v,a[d]=a[c]+h,h+=(v=f[_+1])*v,a[d+1]=a[c+1]+h;for(;l<o;++l,++_,++d,++c)h+=(v=f[_])*v,a[d]=a[c]+h}}if(e){for(u=0;u<n;++u)e[u]=0;for(d=n+1|0,c=0,u=0,_=0;u<i;++u,++d,++c){for(l=0;l<=o-2;l+=2,_+=2,d+=2,c+=2)e[d]=f[_]+e[c],e[d+1]=f[_+1]+e[c+1];for(;l<o;++l,++_,++d,++c)e[d]=f[_]+e[c]}for(d=n+o|0,c=o,u=0;u<i;++u,d+=n,c+=n)e[d]+=e[c];for(l=o-1;l>0;--l)for(c=(d=l+i*n)-n,u=i;u>0;--u,d-=n,c-=n)e[d]+=e[c]+e[c+1]}},equalize_histogram:function(t,r){var a=t.cols,e=t.rows,f=t.data;r.resize(a,e,t.channel);var n,s,h=r.data,d=a*e,c=0,u=0,l=o(1024);for(n=l.i32;c<256;++c)n[c]=0;for(c=0;c<d;++c)++n[f[c]];for(u=n[0],c=1;c<256;++c)u=n[c]+=u;for(s=255/d,c=0;c<d;++c)h[c]=n[f[c]]*s+.5|0;i(l)},canny:function(t,r,e,f){var n=t.cols,s=t.rows;r.resize(n,s,t.channel);var h=r.data,d=0,c=0,u=0,v=n<<1,_=0,p=0,y=0,x=0,m=0,w=0,b=0,M=0,g=o(s*v<<2),k=o(3*(n+2)<<2),z=o((s+2)*(n+2)<<2),A=o(s*n<<2),C=k.i32,O=z.i32,R=A.i32,S=g.i32,L=new a.matrix_t(n,s,a.S32C2_t,g.data),I=1,U=n+2+1|0,q=2*(n+2)+1|0,G=n+2|0,F=G+1|0,B=0;for(l(t,L),e>f&&(d=e,e=f,f=d),d=3*(n+2)|0;--d>=0;)C[d]=0;for(d=(s+2)*(n+2)|0;--d>=0;)O[d]=0;for(;c<n;++c,u+=2)x=S[u],m=S[u+1],C[U+c]=(x^x>>31)-(x>>31)+((m^m>>31)-(m>>31));for(d=1;d<=s;++d,u+=v){if(d==s)for(c=q+n;--c>=q;)C[c]=0;else for(c=0;c<n;c++)x=S[u+(c<<1)],m=S[u+(c<<1)+1],C[q+c]=(x^x>>31)-(x>>31)+((m^m>>31)-(m>>31));for(_=u-v|0,O[F-1]=0,p=0,c=0;c<n;++c,_+=2){if((y=C[U+c])>e)if(w=(x=S[_])^(m=S[_+1]),m=(m^m>>31)-(m>>31)|0,M=(b=13573*(x=(x^x>>31)-(x>>31)|0))+(x+x<<15),(m<<=15)<b){if(y>C[U+c-1]&&y>=C[U+c+1]){y>f&&!p&&2!=O[F+c-G]?(O[F+c]=2,p=1,R[B++]=F+c):O[F+c]=1;continue}}else if(m>M){if(y>C[I+c]&&y>=C[q+c]){y>f&&!p&&2!=O[F+c-G]?(O[F+c]=2,p=1,R[B++]=F+c):O[F+c]=1;continue}}else if(y>C[I+c-(w=w<0?-1:1)]&&y>C[q+c+w]){y>f&&!p&&2!=O[F+c-G]?(O[F+c]=2,p=1,R[B++]=F+c):O[F+c]=1;continue}O[F+c]=0,p=0}O[F+n]=0,F+=G,c=I,I=U,U=q,q=c}for(c=F-G-1,d=0;d<G;++d,++c)O[c]=0;for(;B>0;)F=R[--B],1==O[F-=G+1]&&(O[F]=2,R[B++]=F),1==O[F+=1]&&(O[F]=2,R[B++]=F),1==O[F+=1]&&(O[F]=2,R[B++]=F),1==O[F+=G]&&(O[F]=2,R[B++]=F),1==O[F-=2]&&(O[F]=2,R[B++]=F),1==O[F+=G]&&(O[F]=2,R[B++]=F),1==O[F+=1]&&(O[F]=2,R[B++]=F),1==O[F+=1]&&(O[F]=2,R[B++]=F);for(F=G+1,I=0,d=0;d<s;++d,F+=G)for(c=0;c<n;++c)h[I++]=255*(2==O[F+c]);i(g),i(k),i(z),i(A)},warp_perspective:function(t,r,a,e){void 0===e&&(e=0);for(var o=0|t.cols,i=0|t.rows,f=0|r.cols,n=0|r.rows,s=t.data,h=r.data,d=0,c=0,u=0,l=0,v=0,_=0,p=0,y=0,x=0,m=0,w=0,b=0,M=0,g=0,k=0,z=a.data,A=z[0],C=z[1],O=z[2],R=z[3],S=z[4],L=z[5],I=z[6],U=z[7],q=z[8],G=0;c<n;++c)for(y=C*c+O,x=S*c+L,m=U*c+q,d=0;d<f;++d,++G,y+=A,x+=R,m+=I)l=0|(_=y*(w=1/m)),v=0|(p=x*w),_>0&&p>0&&l<o-1&&v<i-1?(b=Math.max(_-l,0),M=Math.max(p-v,0),g=s[u=o*v+l|0]+b*(s[u+1]-s[u]),k=s[u+o]+b*(s[u+o+1]-s[u+o]),h[G]=g+M*(k-g)):h[G]=e},warp_affine:v,skindetector:function(t,r){for(var a,e,o,i,f=t.width*t.height;f--;)i=4*f,a=t.data[i],e=t.data[i+1],o=t.data[i+2],a>95&&e>40&&o>20&&a>e&&a>o&&a-Math.min(e,o)>15&&Math.abs(a-e)>15?r[f]=255:r[f]=0}});_=a,p=new Int32Array([-1,1,4,-1,4,-1,-1,-1,8,-1,-1,-1,-1,-1,-1,-1,8]),y=function(t){return 65280&t},x=function(t){return 255&t},m=function(t){return p[(65280&t)>>8]},w=function(t,r){this.size=-8&(t+7|0),void 0===r?this.buffer=new ArrayBuffer(this.size):(this.buffer=r,this.size=r.length),this.u8=new Uint8Array(this.buffer),this.i32=new Int32Array(this.buffer),this.f32=new Float32Array(this.buffer),this.f64=new Float64Array(this.buffer)},b=function(){function t(t,r,a,e){this.type=0|y(a),this.channel=0|x(a),this.cols=0|t,this.rows=0|r,void 0===e?this.allocate():(this.buffer=e,this.data=256&this.type?this.buffer.u8:512&this.type?this.buffer.i32:1024&this.type?this.buffer.f32:this.buffer.f64)}return t.prototype.allocate=function(){delete this.data,delete this.buffer,this.buffer=new w(this.cols*m(this.type)*this.channel*this.rows),this.data=256&this.type?this.buffer.u8:512&this.type?this.buffer.i32:1024&this.type?this.buffer.f32:this.buffer.f64},t.prototype.copy_to=function(t){for(var r=t.data,a=this.data,e=0,o=this.cols*this.rows*this.channel|0;e<o-4;e+=4)r[e]=a[e],r[e+1]=a[e+1],r[e+2]=a[e+2],r[e+3]=a[e+3];for(;e<o;++e)r[e]=a[e]},t.prototype.resize=function(t,r,a){void 0===a&&(a=this.channel),t*m(this.type)*a*r>this.buffer.size?(this.cols=t,this.rows=r,this.channel=a,this.allocate()):(this.cols=t,this.rows=r,this.channel=a)},t}(),M=function(){function t(t){this.levels=0|t,this.data=new Array(t),this.pyrdown=c}return t.prototype.allocate=function(t,r,a){for(var e=this.levels;--e>=0;)this.data[e]=new b(t>>e,r>>e,a)},t.prototype.build=function(t,r){void 0===r&&(r=!0);var a=2,e=t,o=this.data[0];if(!r)for(var i=t.cols*t.rows;--i>=0;)o.data[i]=t.data[i];for(o=this.data[1],this.pyrdown(e,o);a<this.levels;++a)e=o,o=this.data[a],this.pyrdown(e,o)},t}(),g=function(t,r,a,e,o){void 0===t&&(t=0),void 0===r&&(r=0),void 0===a&&(a=0),void 0===e&&(e=0),void 0===o&&(o=-1),this.x=t,this.y=r,this.score=a,this.level=e,this.angle=o},_.U8_t=256,_.S32_t=512,_.F32_t=1024,_.S64_t=2048,_.F64_t=4096,_.C1_t=1,_.C2_t=2,_.C3_t=3,_.C4_t=4,_.U8C1_t=257,_.U8C3_t=259,_.U8C4_t=260,_.F32C1_t=1025,_.F32C2_t=1026,_.S32C1_t=513,_.S32C2_t=514,_.EPSILON=1.192092896e-7,_.FLT_MIN=1e-37,_.COLOR_RGBA2GRAY=0,_.COLOR_RGB2GRAY=1,_.COLOR_BGRA2GRAY=2,_.COLOR_BGR2GRAY=3,_.BOX_BLUR_NOSCALE=1,_.SVD_U_T=1,_.SVD_V_T=2,_.get_data_type=y,_.get_channel=x,_.get_data_type_size=m,_.data_t=w,_.matrix_t=b,_.pyramid_t=M,_.keypoint_t=g;const z=function(t,r){for(var a=0,e=0,o=r.rows,i=r.cols,f=0,n=0,s=0,h=r.data,d=t.data;a<o;n+=1,f+=i,a++)for(s=n,e=0;e<i;s+=o,e++)d[s]=h[f+e]},A=function(t,r,a){for(var e=0,o=0,i=0,f=0,n=0,s=0,h=0,d=0,c=r.cols,u=r.rows,l=a.cols,v=r.data,_=a.data,p=t.data,y=0;e<c;f++,e++)for(h=0,o=0;o<l;d++,h++,o++){for(s=h,n=f,y=0,i=0;i<u;n+=c,s+=l,i++)y+=v[n]*_[s];p[d]=y}},C=function(t,r){for(var a=0,e=0,o=0,i=0,f=0,n=0,s=0,h=0,d=0,c=r.cols,u=r.rows,l=r.data,v=t.data,_=0;a<c;s+=c,a++)for(i=a,h=d=s+a,e=a;e<c;h++,d+=c,e++){for(f=i,n=e,_=0,o=0;o<u;f+=c,n+=c,o++)_+=l[f]*l[n];v[h]=_,v[d]=_}},O=function(t,r){var a=t.data,e=r.data,o=a[4],i=a[8],f=a[5],n=a[7],s=a[0],h=s*o,d=s*f,c=a[3],u=a[1],l=c*u,v=a[2],_=c*v,p=a[6],y=p*u,x=p*v,m=1/(h*i-d*n-l*i+_*n+y*f-x*o);e[0]=(o*i-f*n)*m,e[1]=-(u*i-v*n)*m,e[2]=-(-u*f+v*o)*m,e[3]=-(c*i-f*p)*m,e[4]=(s*i-x)*m,e[5]=-(d-_)*m,e[6]=-(-c*n+o*p)*m,e[7]=-(s*n-y)*m,e[8]=(h-l)*m},R=function(t,r,a){var e=t.data,o=r.data,i=a.data,f=o[0],n=o[1],s=o[2],h=o[3],d=o[4],c=o[5],u=o[6],l=o[7],v=o[8],_=i[0],p=i[1],y=i[2],x=i[3],m=i[4],w=i[5],b=i[6],M=i[7],g=i[8];e[0]=f*_+n*x+s*b,e[1]=f*p+n*m+s*M,e[2]=f*y+n*w+s*g,e[3]=h*_+d*x+c*b,e[4]=h*p+d*m+c*M,e[5]=h*y+d*w+c*g,e[6]=u*_+l*x+v*b,e[7]=u*p+l*m+v*M,e[8]=u*y+l*w+v*g},S=function(t,r,a,e,o,i,f,n,s){return t*o*s-t*i*n-e*r*s+e*a*n+f*r*i-f*a*o};var L=Object.freeze({__proto__:null,identity:function(t,r){void 0===r&&(r=1);for(var a=t.data,e=t.rows,o=t.cols,i=o+1|0,f=e*o,n=f;--f>=0;)a[f]=0;for(f=n,n=0;n<f;)a[n]=r,n+=i},transpose:z,multiply:function(t,r,a){for(var e=0,o=0,i=0,f=0,n=0,s=0,h=0,d=0,c=r.cols,u=r.rows,l=a.cols,v=r.data,_=a.data,p=t.data,y=0;e<u;f+=c,e++)for(h=0,o=0;o<l;d++,h++,o++){for(s=h,n=f,y=0,i=0;i<c;n++,s+=l,i++)y+=v[n]*_[s];p[d]=y}},multiply_ABt:function(t,r,a){for(var e=0,o=0,i=0,f=0,n=0,s=0,h=0,d=r.cols,c=r.rows,u=a.rows,l=r.data,v=a.data,_=t.data,p=0;e<c;f+=d,e++)for(s=0,o=0;o<u;h++,o++){for(n=f,p=0,i=0;i<d;n++,s++,i++)p+=l[n]*v[s];_[h]=p}},multiply_AtB:A,multiply_AAt:function(t,r){for(var a=0,e=0,o=0,i=0,f=0,n=0,s=0,h=0,d=0,c=r.cols,u=r.rows,l=r.data,v=t.data,_=0;a<u;i+=u+1,f=n,a++)for(h=i,d=i,s=f,e=a;e<u;h++,d+=u,e++){for(n=f,_=0,o=0;o<c;o++)_+=l[n++]*l[s++];v[h]=_,v[d]=_}},multiply_AtA:C,identity_3x3:function(t,r){void 0===r&&(r=1);var a=t.data;a[0]=a[4]=a[8]=r,a[1]=a[2]=a[3]=0,a[5]=a[6]=a[7]=0},invert_3x3:O,multiply_3x3:R,mat3x3_determinant:function(t){var r=t.data;return r[0]*r[4]*r[8]-r[0]*r[5]*r[7]-r[3]*r[1]*r[8]+r[3]*r[2]*r[7]+r[6]*r[1]*r[5]-r[6]*r[2]*r[4]},determinant_3x3:S}),I=function(t,r,a,e){e=t[r],t[r]=t[a],t[a]=e},U=function(t,r){return(t=Math.abs(t))>(r=Math.abs(r))?(r/=t,t*Math.sqrt(1+r*r)):r>0?(t/=r,r*Math.sqrt(1+t*t)):0};const q=function(t,r){var e,o,i,f,n=0,s=0,h=0,d=t.cols,c=t.data,u=r.data;for(n=0;n<d;n++){for(h=n,s=n+1;s<d;s++)Math.abs(c[s*d+n])>Math.abs(c[h*d+n])&&(h=s);if(Math.abs(c[h*d+n])<a.EPSILON)return 0;if(h!=n){for(s=n;s<d;s++)I(c,n*d+s,h*d+s,e);I(u,n,h,e)}for(i=-1/c[n*d+n],s=n+1;s<d;s++){for(o=c[s*d+n]*i,h=n+1;h<d;h++)c[s*d+h]+=o*c[n*d+h];u[s]+=o*u[n]}c[n*d+n]=-i}for(n=d-1;n>=0;n--){for(f=u[n],h=n+1;h<d;h++)f-=c[n*d+h]*u[h];u[n]=f*c[n*d+n]}return 1},G=function(t,r,e){for(var f=t.cols,n=f*f,s=t.type|a.C1_t,h=o(f*f<<3),d=o(f<<3),c=new a.matrix_t(f,f,s,h.data),u=new a.matrix_t(1,f,s,d.data);--n>=0;)c.data[n]=t.data[n];if(function(t,r,e,f,n,s){var h=a.EPSILON,d=0,c=0,u=0,l=0,v=0,_=0,p=0,y=0,x=0,m=s*s*30,w=0,b=0,M=0,g=0,k=0,z=0,A=0,C=0,O=0,R=o(s<<2),S=o(s<<2),L=R.i32,q=S.i32;if(f)for(;d<s;d++){for(u=d*n,c=0;c<s;c++)f[u+c]=0;f[u+d]=1}for(u=0;u<s;u++){if(e[u]=t[(r+1)*u],u<s-1){for(l=u+1,w=Math.abs(t[r*u+l]),d=u+2;d<s;d++)w<(b=Math.abs(t[r*u+d]))&&(w=b,l=d);L[u]=l}if(u>0){for(l=0,w=Math.abs(t[u]),d=1;d<u;d++)w<(b=Math.abs(t[r*d+u]))&&(w=b,l=d);q[u]=l}}if(s>1)for(;x<m;x++){for(u=0,w=Math.abs(t[L[0]]),d=1;d<s-1;d++)w<(b=Math.abs(t[r*d+L[d]]))&&(w=b,u=d);for(v=L[u],d=1;d<s;d++)w<(b=Math.abs(t[r*q[d]+d]))&&(w=b,u=q[d],v=d);if(M=t[r*u+v],Math.abs(M)<=h)break;for(g=.5*(e[v]-e[u]),A=(k=Math.abs(g)+U(M,g))/(z=U(M,k)),z=M/z,k=M/k*M,g<0&&(z=-z,k=-k),t[r*u+v]=0,e[u]-=k,e[v]+=k,d=0;d<u;d++)y=r*d+v,C=t[p=r*d+u],O=t[y],t[p]=C*A-O*z,t[y]=C*z+O*A;for(d=u+1;d<v;d++)y=r*d+v,C=t[p=r*u+d],O=t[y],t[p]=C*A-O*z,t[y]=C*z+O*A;for(p=r*u+(d=v+1),y=r*v+d;d<s;d++,p++,y++)C=t[p],O=t[y],t[p]=C*A-O*z,t[y]=C*z+O*A;if(f)for(p=n*u,y=n*v,d=0;d<s;d++,p++,y++)C=f[p],O=f[y],f[p]=C*A-O*z,f[y]=C*z+O*A;for(c=0;c<2;c++){if((_=0==c?u:v)<s-1){for(l=_+1,w=Math.abs(t[r*_+l]),d=_+2;d<s;d++)w<(b=Math.abs(t[r*_+d]))&&(w=b,l=d);L[_]=l}if(_>0){for(l=0,w=Math.abs(t[_]),d=1;d<_;d++)w<(b=Math.abs(t[r*d+_]))&&(w=b,l=d);q[_]=l}}}for(u=0;u<s-1;u++){for(l=u,d=u+1;d<s;d++)e[l]<e[d]&&(l=d);if(u!=l&&(I(e,l,u,w),f))for(d=0;d<s;d++)I(f,n*l+d,n*u+d,w)}i(R),i(S)}(c.data,f,u.data,r?r.data:null,f,f),e)for(;--f>=0;)e.data[f]=u.data[f];i(h),i(d)};var F=Object.freeze({__proto__:null,lu_solve:q,cholesky_solve:function(t,r){var a,e,o=0,i=0,f=0,n=0,s=0,h=0,d=0,c=t.cols,u=t.data,l=r.data;for(o=0;o<c;o++)for(e=1,s=n=o*c,i=o;i<c;i++){for(a=u[s+o],f=0;f<o;f++)a-=u[f*c+o]*u[s+f];if(i==o){if(u[s+o]=a,0==a)return 0;e=1/a}else u[n+i]=a,u[s+o]=a*e;s+=c}for(n=0,h=0;h<c;h++){for(a=l[h],d=0;d<h;d++)a-=u[n+d]*l[d];l[h]=a,n+=c}for(n=0,h=0;h<c;h++)l[h]/=u[n+h],n+=c;for(h=c-1;h>=0;h--){for(a=l[h],n=(d=h+1)*c;d<c;d++)a-=u[n+h]*l[d],n+=c;l[h]=a}return 1},svd_decompose:function(t,r,e,f,n){void 0===n&&(n=0);var s=0,h=0,d=t.rows,c=t.cols,u=d,l=c,v=t.type|a.C1_t;u<l&&(s=1,h=u,u=l,l=h);var _=o(u*u<<3),p=o(l<<3),y=o(l*l<<3),x=new a.matrix_t(u,u,v,_.data),m=new a.matrix_t(1,l,v,p.data),w=new a.matrix_t(l,l,v,y.data);if(0==s)z(x,t);else{for(h=0;h<c*d;h++)x.data[h]=t.data[h];for(;h<l*u;h++)x.data[h]=0}if(function(t,r,e,f,n,s,h,d){for(var c=2*a.EPSILON,u=a.FLT_MIN,l=0,v=0,_=0,p=0,y=Math.max(s,30),x=0,m=0,w=0,b=0,M=0,g=0,k=0,z=0,A=0,C=0,O=0,R=0,S=0,L=0,q=0,G=0,F=0,B=4660,N=0,E=0,P=0,V=o(h<<3),j=V.f64;l<h;l++){for(_=0,O=0;_<s;_++)O+=(z=t[l*r+_])*z;if(j[l]=O,f){for(_=0;_<h;_++)f[l*n+_]=0;f[l*n+l]=1}}for(;p<y;p++){for(M=0,l=0;l<h-1;l++)for(v=l+1;v<h;v++){for(x=l*r|0,m=v*r|0,q=j[l],G=0,F=j[v],_=2,G+=t[x]*t[m],G+=t[x+1]*t[m+1];_<s;_++)G+=t[x+_]*t[m+_];if(!(Math.abs(G)<=c*Math.sqrt(q*F))){for(S=U(G*=2,R=q-F),R<0?(L=.5*(S-R),g=G/(S*(k=Math.sqrt(L/S))*2)):k=G/(S*(g=Math.sqrt((S+R)/(2*S)))*2),q=0,F=0,_=2,A=g*t[x]+k*t[m],C=-k*t[x]+g*t[m],t[x]=A,t[m]=C,q+=A*A,F+=C*C,A=g*t[x+1]+k*t[m+1],C=-k*t[x+1]+g*t[m+1],t[x+1]=A,t[m+1]=C,q+=A*A,F+=C*C;_<s;_++)A=g*t[x+_]+k*t[m+_],C=-k*t[x+_]+g*t[m+_],t[x+_]=A,t[m+_]=C,q+=A*A,F+=C*C;if(j[l]=q,j[v]=F,M=1,f)for(b=v*n|0,_=2,A=g*f[w=l*n|0]+k*f[b],C=-k*f[w]+g*f[b],f[w]=A,f[b]=C,A=g*f[w+1]+k*f[b+1],C=-k*f[w+1]+g*f[b+1],f[w+1]=A,f[b+1]=C;_<h;_++)A=g*f[w+_]+k*f[b+_],C=-k*f[w+_]+g*f[b+_],f[w+_]=A,f[b+_]=C}}if(0==M)break}for(l=0;l<h;l++){for(_=0,O=0;_<s;_++)O+=(z=t[l*r+_])*z;j[l]=Math.sqrt(O)}for(l=0;l<h-1;l++){for(v=l,_=l+1;_<h;_++)j[v]<j[_]&&(v=_);if(l!=v&&(I(j,l,v,O),f)){for(_=0;_<s;_++)I(t,l*r+_,v*r+_,z);for(_=0;_<h;_++)I(f,l*n+_,v*n+_,z)}}for(l=0;l<h;l++)e[l]=j[l];if(f){for(l=0;l<d;l++){for(O=l<h?j[l]:0;O<=u;){for(E=1/s,_=0;_<s;_++)N=0!=(256&(B=214013*B+2531011)>>16)?E:-E,t[l*r+_]=N;for(p=0;p<2;p++)for(v=0;v<l;v++){for(O=0,_=0;_<s;_++)O+=t[l*r+_]*t[v*r+_];for(P=0,_=0;_<s;_++)z=t[l*r+_]-O*t[v*r+_],t[l*r+_]=z,P+=Math.abs(z);for(P=P?1/P:0,_=0;_<s;_++)t[l*r+_]*=P}for(O=0,_=0;_<s;_++)O+=(z=t[l*r+_])*z;O=Math.sqrt(O)}for(k=1/O,_=0;_<s;_++)t[l*r+_]*=k}i(V)}else i(V)}(x.data,u,m.data,w.data,l,u,l,u),r){for(h=0;h<l;h++)r.data[h]=m.data[h];for(;h<c;h++)r.data[h]=0}if(0==s){if(e&&n&a.SVD_U_T)for(h=u*u;--h>=0;)e.data[h]=x.data[h];else e&&z(e,x);if(f&&n&a.SVD_V_T)for(h=l*l;--h>=0;)f.data[h]=w.data[h];else f&&z(f,w)}else{if(e&&n&a.SVD_U_T)for(h=l*l;--h>=0;)e.data[h]=w.data[h];else e&&z(e,w);if(f&&n&a.SVD_V_T)for(h=u*u;--h>=0;)f.data[h]=x.data[h];else f&&z(f,x)}i(_),i(p),i(y)},svd_solve:function(t,r,e){var f,n=0,s=0,h=0,d=0,c=0,u=t.rows,l=t.cols,v=0,_=0,p=t.type|a.C1_t,y=o(u*u<<3),x=o(l<<3),m=o(l*l<<3),w=new a.matrix_t(u,u,p,y.data),b=new a.matrix_t(1,l,p,x.data),M=new a.matrix_t(l,l,p,m.data),g=e.data,k=w.data,z=b.data,A=M.data;for(this.svd_decompose(t,b,w,M,0),f=a.EPSILON*z[0]*l;n<l;n++,c+=l){for(_=0,s=0;s<l;s++)if(z[s]>f){for(h=0,v=0,d=0;h<u;h++,d+=l)v+=k[d+s]*g[h];_+=v*A[c+s]/z[s]}r.data[n]=_}i(y),i(x),i(m)},svd_invert:function(t,r){var e,f=0,n=0,s=0,h=0,d=0,c=0,u=r.rows,l=r.cols,v=0,_=r.type|a.C1_t,p=o(u*u<<3),y=o(l<<3),x=o(l*l<<3),m=new a.matrix_t(u,u,_,p.data),w=new a.matrix_t(1,l,_,y.data),b=new a.matrix_t(l,l,_,x.data),M=t.data,g=m.data,k=w.data,z=b.data;for(this.svd_decompose(r,w,m,b,0),e=a.EPSILON*k[0]*l;f<l;f++,d+=l)for(n=0,h=0;n<u;n++,c++){for(s=0,v=0;s<l;s++,h++)k[s]>e&&(v+=z[d+s]*g[h]/k[s]);M[c]=v}i(p),i(y),i(x)},eigenVV:G});!function(t){var r,e,f,n,h,d,c,u,l,v,_=(r=function(t){return t*t},e=new a.matrix_t(3,3,a.F32_t|a.C1_t),f=new a.matrix_t(3,3,a.F32_t|a.C1_t),n=new a.matrix_t(6,6,a.F32_t|a.C1_t),h=new a.matrix_t(6,1,a.F32_t|a.C1_t),d=function(){function t(){}return t.prototype.run=function(t,r,s,d){var c,u,l=0,v=0,_=s.type|a.C1_t,p=s.data,y=e.data,x=f.data,m=0,w=0;!function(t,r,a,e,o){for(var i,f,n=0,s=0,h=0,d=0,c=0,u=0,l=0,v=0,_=0;n<o;++n)s+=t[n].x,h+=t[n].y,c+=r[n].x,u+=r[n].y;for(s/=o,h/=o,c/=o,u/=o,n=0;n<o;++n)v=t[n].x-s,_=t[n].y-h,d+=Math.sqrt(v*v+_*_),v=r[n].x-c,_=r[n].y-u,l+=Math.sqrt(v*v+_*_);d/=o,l/=o,i=Math.SQRT2/d,f=Math.SQRT2/l,a[0]=a[4]=i,a[2]=-s*i,a[5]=-h*i,a[1]=a[3]=a[6]=a[7]=0,a[8]=1,e[0]=e[4]=f,e[2]=-c*f,e[5]=-u*f,e[1]=e[3]=e[6]=e[7]=0,e[8]=1}(t,r,y,x,d);for(var b=o(2*d*6<<3),M=o(2*d<<3),g=new a.matrix_t(6,2*d,_,b.data),k=new a.matrix_t(1,2*d,_,M.data),z=g.data,S=k.data;l<d;++l)c=t[l],u=r[l],m=y[0]*c.x+y[1]*c.y+y[2],w=y[3]*c.x+y[4]*c.y+y[5],z[v=2*l*6]=m,z[v+1]=w,z[v+2]=1,z[v+3]=0,z[v+4]=0,z[v+5]=0,z[v+=6]=0,z[v+1]=0,z[v+2]=0,z[v+3]=m,z[v+4]=w,z[v+5]=1,S[l<<1]=x[0]*u.x+x[1]*u.y+x[2],S[1+(l<<1)]=x[3]*u.x+x[4]*u.y+x[5];return C(n,g),A(h,g,k),q(n,h),p[0]=h.data[0],p[1]=h.data[1],p[2]=h.data[2],p[3]=h.data[3],p[4]=h.data[4],p[5]=h.data[5],p[6]=0,p[7]=0,p[8]=1,O(f,f),R(s,f,s),R(s,s,e),i(b),i(M),1},t.prototype.error=function(t,a,e,o,i){for(var f,n,s=0,h=e.data;s<i;++s)f=t[s],n=a[s],o[s]=r(n.x-h[0]*f.x-h[1]*f.y-h[2])+r(n.y-h[3]*f.x-h[4]*f.y-h[5])},t.prototype.check_subset=function(){return!0},t}(),c=new a.matrix_t(9,9,a.F32_t|a.C1_t),u=new a.matrix_t(9,9,a.F32_t|a.C1_t),{affine2d:d,homography2d:function(){function t(){}return t.prototype.run=function(t,r,o,i){for(var n=0,s=0,h=o.data,d=e.data,l=f.data,v=c.data,_=u.data,p=0,y=0,x=0,m=0,w=0,b=0,M=0,g=0,k=0,z=0,A=0,C=0;n<i;++n)M+=r[n].x,g+=r[n].y,A+=t[n].x,C+=t[n].y;for(M/=i,g/=i,A/=i,C/=i,n=0;n<i;++n)w+=Math.abs(r[n].x-M),b+=Math.abs(r[n].y-g),k+=Math.abs(t[n].x-A),z+=Math.abs(t[n].y-C);if(Math.abs(w)<a.EPSILON||Math.abs(b)<a.EPSILON||Math.abs(k)<a.EPSILON||Math.abs(z)<a.EPSILON)return 0;for(w=i/w,b=i/b,k=i/k,z=i/z,d[0]=k,d[1]=0,d[2]=-A*k,d[3]=0,d[4]=z,d[5]=-C*z,d[6]=0,d[7]=0,d[8]=1,l[0]=1/w,l[1]=0,l[2]=M,l[3]=0,l[4]=1/b,l[5]=g,l[6]=0,l[7]=0,l[8]=1,n=81;--n>=0;)v[n]=0;for(n=0;n<i;++n)p=(r[n].x-M)*w,y=(r[n].y-g)*b,x=(t[n].x-A)*k,m=(t[n].y-C)*z,v[0]+=x*x,v[1]+=x*m,v[2]+=x,v[6]+=x*-p*x,v[7]+=x*-p*m,v[8]+=x*-p,v[10]+=m*m,v[11]+=m,v[15]+=m*-p*x,v[16]+=m*-p*m,v[17]+=m*-p,v[20]+=1,v[24]+=-p*x,v[25]+=-p*m,v[26]+=-p,v[30]+=x*x,v[31]+=x*m,v[32]+=x,v[33]+=x*-y*x,v[34]+=x*-y*m,v[35]+=x*-y,v[40]+=m*m,v[41]+=m,v[42]+=m*-y*x,v[43]+=m*-y*m,v[44]+=m*-y,v[50]+=1,v[51]+=-y*x,v[52]+=-y*m,v[53]+=-y,v[60]+=-p*x*-p*x+-y*x*-y*x,v[61]+=-p*x*-p*m+-y*x*-y*m,v[62]+=-p*x*-p+-y*x*-y,v[70]+=-p*m*-p*m+-y*m*-y*m,v[71]+=-p*m*-p+-y*m*-y,v[80]+=-p*-p+-y*-y;for(n=0;n<9;++n)for(s=0;s<n;++s)v[9*n+s]=v[9*s+n];return G(c,u),h[0]=_[72],h[1]=_[73],h[2]=_[74],h[3]=_[75],h[4]=_[76],h[5]=_[77],h[6]=_[78],h[7]=_[79],h[8]=_[80],R(o,f,o),R(o,o,e),p=1/h[8],h[0]*=p,h[1]*=p,h[2]*=p,h[3]*=p,h[4]*=p,h[5]*=p,h[6]*=p,h[7]*=p,h[8]=1,1},t.prototype.error=function(t,r,a,e,o){for(var i,f,n=0,s=0,h=0,d=0,c=a.data;n<o;++n)i=t[n],f=r[n],s=1/(c[6]*i.x+c[7]*i.y+1),h=(c[0]*i.x+c[1]*i.y+c[2])*s-f.x,d=(c[3]*i.x+c[4]*i.y+c[5])*s-f.y,e[n]=h*h+d*d},t.prototype.check_subset=function(t,r,a){if(4==a){var e=0,o=t[0],i=t[1],f=t[2],n=t[3],s=r[0],h=r[1],d=r[2],c=r[3],u=o.x,l=o.y,v=i.x,_=i.y,p=f.x,y=f.y,x=s.x,m=s.y,w=h.x,b=h.y,M=d.x,g=d.y,k=S(u,l,1,v,_,1,p,y,1),z=S(x,m,1,w,b,1,M,g,1);if(k*z<0&&e++,u=i.x,l=i.y,v=f.x,_=f.y,p=n.x,y=n.y,x=h.x,m=h.y,w=d.x,b=d.y,M=c.x,g=c.y,(k=S(u,l,1,v,_,1,p,y,1))*(z=S(x,m,1,w,b,1,M,g,1))<0&&e++,u=o.x,l=o.y,v=f.x,_=f.y,p=n.x,y=n.y,x=s.x,m=s.y,w=d.x,b=d.y,M=c.x,g=c.y,(k=S(u,l,1,v,_,1,p,y,1))*(z=S(x,m,1,w,b,1,M,g,1))<0&&e++,u=o.x,l=o.y,v=i.x,_=i.y,p=n.x,y=n.y,x=s.x,m=s.y,w=h.x,b=h.y,M=c.x,g=c.y,(k=S(u,l,1,v,_,1,p,y,1))*(z=S(x,m,1,w,b,1,M,g,1))<0&&e++,0!=e&&4!=e)return!1}return!0},t}()}),p=function(){function t(t,r,a,e){void 0===t&&(t=0),void 0===r&&(r=.5),void 0===a&&(a=.5),void 0===e&&(e=.99),this.size=t,this.thresh=r,this.eps=a,this.prob=e}return t.prototype.update_iters=function(t,r){var a=Math.log(1-this.prob),e=Math.log(1-Math.pow(1-t,this.size));return 0|(e>=0||-a>=r*-e?r:Math.round(a/e))},t}(),y=(l=function(t,r,a,e,o,i,f){for(var n=[],s=0,h=0,d=0,c=0,u=!1;d<1e3;++d){for(s=0;s<e&&d<1e3;){for(u=!1,c=0;!u;)for(u=!0,c=n[s]=0|Math.floor(Math.random()*o),h=0;h<s;++h)if(c==n[h]){u=!1;break}i[s]=r[c],f[s]=a[c],t.check_subset(i,f,s+1)?++s:d++}break}return s==e&&d<1e3},v=function(t,r,a,e,o,i,f,n){var s=0,h=0,d=0,c=i*i;for(t.error(a,e,r,f,o);h<o;++h)d=f[h]<=c,n[h]=d,s+=d;return s},{ransac:function(t,r,e,f,n,s,h,d){if(void 0===d&&(d=1e3),n<t.size)return!1;var c=t.size,u=d,_=0,p=!1,y=[],x=[],m=s.cols,w=s.rows,b=s.type|a.C1_t,M=o(m*w<<3),g=o(n),k=o(n<<2),z=new a.matrix_t(m,w,b,M.data),A=new a.matrix_t(n,1,a.U8C1_t,g.data),C=-1,O=0,R=k.f32;if(n==c){if(r.run(e,f,z,n)<=0)return i(M),i(g),i(k),!1;if(z.copy_to(s),h)for(;--n>=0;)h.data[n]=1;return i(M),i(g),i(k),!0}for(;_<u;++_){if(!l(r,e,f,c,n,y,x)){if(0==_)return i(M),i(g),i(k),!1;break}r.run(y,x,z,c)<=0||(O=v(r,z,e,f,n,t.thresh,R,A.data))>Math.max(C,c-1)&&(z.copy_to(s),C=O,h&&A.copy_to(h),u=t.update_iters((n-O)/n,u),p=!0)}return i(M),i(g),i(k),p},lmeds:function(t,r,e,f,n,h,d,c){if(void 0===c&&(c=1e3),n<t.size)return!1;var u=t.size,_=c,p=0,y=!1,x=[],m=[],w=h.cols,b=h.rows,M=h.type|a.C1_t,g=o(w*b<<3),k=o(n),z=o(n<<2),A=new a.matrix_t(w,b,M,g.data),C=new a.matrix_t(n,1,a.U8_t|a.C1_t,k.data),O=0,R=z.f32,S=1e9,L=0,I=0;if(t.eps=.45,_=t.update_iters(t.eps,_),n==u){if(r.run(e,f,A,n)<=0)return i(g),i(k),i(z),!1;if(A.copy_to(h),d)for(;--n>=0;)d.data[n]=1;return i(g),i(k),i(z),!0}for(;p<_;++p){if(!l(r,e,f,u,n,x,m)){if(0==p)return i(g),i(k),i(z),!1;break}r.run(x,m,A,u)<=0||(r.error(e,f,A,R,n),(I=s(R,0,n-1))<S&&(S=I,A.copy_to(h),y=!0))}return y&&(L=2.5*1.4826*(1+5/(n-u))*Math.sqrt(S),L=Math.max(L,.001),O=v(r,h,e,f,n,L,R,C.data),d&&C.copy_to(d),y=O>=u),i(g),i(k),i(z),y}});t.ransac_params_t=p,t.motion_model=_,t.motion_estimator=y}(a);var B=new Int32Array([0,3,1,3,2,2,3,1,3,0,3,-1,2,-2,1,-3,0,-3,-1,-3,-2,-2,-3,-1,-3,0,-3,1,-2,2,-1,3]),N=new Uint8Array(512),E=new Int32Array(25),P=new Int32Array(25),V=function(t,r,a,e,o){for(var i=0,f=t[r],n=o,s=0,h=0,d=0;i<25;++i)e[i]=f-t[r+a[i]];for(i=0;i<16;i+=2)s=Math.min(e[i+1],e[i+2]),(s=Math.min(s,e[i+3]))<=n||(s=Math.min(s,e[i+4]),s=Math.min(s,e[i+5]),s=Math.min(s,e[i+6]),s=Math.min(s,e[i+7]),s=Math.min(s,e[i+8]),n=Math.max(n,Math.min(s,e[i])),n=Math.max(n,Math.min(s,e[i+9])));for(h=-n,i=0;i<16;i+=2)d=Math.max(e[i+1],e[i+2]),d=Math.max(d,e[i+3]),d=Math.max(d,e[i+4]),(d=Math.max(d,e[i+5]))>=h||(d=Math.max(d,e[i+6]),d=Math.max(d,e[i+7]),d=Math.max(d,e[i+8]),h=Math.min(h,Math.max(d,e[i])),h=Math.min(h,Math.max(d,e[i+9])));return-h-1},j=20;const T=function(t){j=Math.min(Math.max(t,0),255);for(var r=-255;r<=255;++r)N[r+255]=r<-j?1:r>j?2:0;return j};T(20);var Y=Object.freeze({__proto__:null,set_threshold:T,detect:function(t,r,a){void 0===a&&(a=3);var e,f=t.data,n=t.cols,s=t.rows,h=0,d=0,c=0,u=0,l=0,v=o(3*n),_=o(3*(n+1)<<2),p=v.u8,y=_.i32,x=E,m=P,w=Math.max(3,a),b=Math.min(s-2,s-a),M=Math.max(3,a),g=Math.min(n-3,n-a),k=0,z=0,A=V,C=N,O=j,R=0,S=0,L=0,I=0,U=0,q=0,G=0,F=0,T=0,Y=0,D=0,Q=0;!function(t,r,a){for(var e=0,o=B;e<a;++e)t[e]=o[e<<1]+o[1+(e<<1)]*r;for(;e<25;++e)t[e]=t[e-a]}(x,n,16);var X=x[0],H=x[1],J=x[2],K=x[3],W=x[4],Z=x[5],$=x[6],tt=x[7],rt=x[8],at=x[9],et=x[10],ot=x[11],it=x[12],ft=x[13],nt=x[14],st=x[15];for(h=0;h<3*n;++h)p[h]=0;for(h=w;h<b;++h){for(G=h*n+M|0,q=(l=(h-3)%3)*n|0,U=l*(n+1)|0,d=0;d<n;++d)p[q+d]=0;if(I=0,h<b-1)for(d=M;d<g;++d,++G)if(0!=(L=C[(S=255-(R=f[G]))+f[G+X]]|C[S+f[G+rt]])&&(L&=C[S+f[G+J]]|C[S+f[G+et]],L&=C[S+f[G+W]]|C[S+f[G+it]],0!=(L&=C[S+f[G+$]]|C[S+f[G+nt]]))){if(L&=C[S+f[G+H]]|C[S+f[G+at]],L&=C[S+f[G+K]]|C[S+f[G+ot]],L&=C[S+f[G+Z]]|C[S+f[G+ft]],1&(L&=C[S+f[G+tt]]|C[S+f[G+st]]))for(u=R-O,k=0,c=0;c<25;++c)if(f[G+x[c]]<u){if(++k>8){y[U+ ++I]=d,p[q+d]=A(f,G,x,m,O);break}}else k=0;if(2&L)for(u=R+O,k=0,c=0;c<25;++c)if(f[G+x[c]]>u){if(++k>8){y[U+ ++I]=d,p[q+d]=A(f,G,x,m,O);break}}else k=0}if(y[U+n]=I,h!=w)for(F=(l=(h-4+3)%3)*n|0,U=l*(n+1)|0,T=(l=(h-5+3)%3)*n|0,I=y[U+n],c=0;c<I;++c)Y=(d=y[U+c])+1|0,D=d-1|0,(Q=p[F+d])>p[F+Y]&&Q>p[F+D]&&Q>p[T+D]&&Q>p[T+d]&&Q>p[T+Y]&&Q>p[q+D]&&Q>p[q+d]&&Q>p[q+Y]&&((e=r[z]).x=d,e.y=h-1,e.score=Q,z++)}return i(v),i(_),z}});!function(t){var r,a=(r=function(t,r,a,e,o,i,f){var n=-2*t[r]+t[r+e]+t[r-e],s=-2*t[r]+t[r+o]+t[r-o],h=t[r+i]+t[r-i]-t[r+f]-t[r-f],d=0|Math.sqrt((n-s)*(n-s)+4*h*h);return Math.min(Math.abs(a-d),Math.abs(-(a+d)))},{laplacian_threshold:30,min_eigen_value_threshold:25,detect:function(t,a,e){void 0===e&&(e=5);var f,n=0,s=0,h=t.cols,d=t.rows,c=t.data,u=5*h|0,l=3+3*h|0,v=3-3*h|0,_=o(h*d<<2),p=_.i32,y=0,x=0,m=0,w=0,b=0,M=this.laplacian_threshold,g=this.min_eigen_value_threshold,k=0|Math.max(5,e),z=0|Math.max(3,e),A=0|Math.min(h-5,h-e),C=0|Math.min(d-3,d-e);for(n=h*d;--n>=0;)p[n]=0;for(function(t,r,a,e,o,i,f,n,s,h){var d=0,c=0,u=n*a+f|0,l=u;for(d=n;d<h;++d,l=u+=a)for(c=f;c<s;++c,++l)r[l]=-4*t[l]+t[l+o]+t[l-o]+t[l+i]+t[l-i]}(c,p,h,0,5,u,k,z,A,C),x=z*h+k|0,s=z;s<C;++s,x+=h)for(n=k,m=x;n<A;++n,++m)((y=p[m])<-M&&y<p[m-1]&&y<p[m+1]&&y<p[m-h]&&y<p[m+h]&&y<p[m-h-1]&&y<p[m+h-1]&&y<p[m-h+1]&&y<p[m+h+1]||y>M&&y>p[m-1]&&y>p[m+1]&&y>p[m-h]&&y>p[m+h]&&y>p[m-h-1]&&y>p[m+h-1]&&y>p[m-h+1]&&y>p[m+h+1])&&(w=r(c,m,y,5,u,l,v))>g&&((f=a[b]).x=n,f.y=s,f.score=w,++b,++n,++m);return i(_),b}});t.yape06=a}(a),function(t){var r,a,e,o=(r=function(t,r,a,e,o){var i,f;if(a>0)for(r-=e*o,f=-o;f<=o;++f){for(i=-o;i<=o;++i)if(t[r+i]>a)return!1;r+=e}else for(r-=e*o,f=-o;f<=o;++f){for(i=-o;i<=o;++i)if(t[r+i]<a)return!1;r+=e}return!0},a=function(t,r,a,e,o,i,f,n){var s=0,h=0,d=f-1|0,c=0,u=0,l=0,v=0,_=0;if((c=t[r+i[h]])<=o)if(c>=e)if((u=t[r+i[d]])<=o){if(u>=e)return void(a[r]=0);if((l=t[r+i[++d]])>o)if((v=t[r+i[++d]])>o)_=3;else{if(!(v<e))return void(a[r]=0);_=6}else if((v=t[r+i[++d]])>o)_=7;else{if(!(v<e))return void(a[r]=0);_=2}}else if((l=t[r+i[++d]])>o)if((v=t[r+i[++d]])>o)_=3;else{if(!(v<e))return void(a[r]=0);_=6}else{if(!(l<e))return void(a[r]=0);if((v=t[r+i[++d]])>o)_=7;else{if(!(v<e))return void(a[r]=0);_=2}}else{if((u=t[r+i[d]])>o)return void(a[r]=0);if((l=t[r+i[++d]])>o)return void(a[r]=0);if((v=t[r+i[++d]])>o)return void(a[r]=0);_=1}else{if((u=t[r+i[d]])<e)return void(a[r]=0);if((l=t[r+i[++d]])<e)return void(a[r]=0);if((v=t[r+i[++d]])<e)return void(a[r]=0);_=0}for(h=1;h<=f;h++)switch(c=t[r+i[h]],_){case 0:if(c>o){if(l=v,(v=t[r+i[++d]])<e)return void(a[r]=0);s-=c+l,_=0;break}if(c<e){if(l>o)return void(a[r]=0);if(v>o)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])>o)return void(a[r]=0);s-=c+l,_=8;break}if(l<=o)return void(a[r]=0);if(v<=o)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])>o){s-=c+l,_=3;break}if(v<e){s-=c+l,_=6;break}return void(a[r]=0);case 1:if(c<e){if(l=v,(v=t[r+i[++d]])>o)return void(a[r]=0);s-=c+l,_=1;break}if(c>o){if(l<e)return void(a[r]=0);if(v<e)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])<e)return void(a[r]=0);s-=c+l,_=9;break}if(l>=e)return void(a[r]=0);if(v>=e)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])<e){s-=c+l,_=2;break}if(v>o){s-=c+l,_=7;break}return void(a[r]=0);case 2:if(c>o)return void(a[r]=0);if(l=v,v=t[r+i[++d]],c<e){if(v>o)return void(a[r]=0);s-=c+l,_=4;break}if(v>o){s-=c+l,_=7;break}if(v<e){s-=c+l,_=2;break}return void(a[r]=0);case 3:if(c<e)return void(a[r]=0);if(l=v,v=t[r+i[++d]],c>o){if(v<e)return void(a[r]=0);s-=c+l,_=5;break}if(v>o){s-=c+l,_=3;break}if(v<e){s-=c+l,_=6;break}return void(a[r]=0);case 4:if(c>o)return void(a[r]=0);if(c<e){if(l=v,(v=t[r+i[++d]])>o)return void(a[r]=0);s-=c+l,_=1;break}if(v>=e)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])<e){s-=c+l,_=2;break}if(v>o){s-=c+l,_=7;break}return void(a[r]=0);case 5:if(c<e)return void(a[r]=0);if(c>o){if(l=v,(v=t[r+i[++d]])<e)return void(a[r]=0);s-=c+l,_=0;break}if(v<=o)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])>o){s-=c+l,_=3;break}if(v<e){s-=c+l,_=6;break}return void(a[r]=0);case 7:if(c>o)return void(a[r]=0);if(c<e)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])>o){s-=c+l,_=3;break}if(v<e){s-=c+l,_=6;break}return void(a[r]=0);case 6:if(c>o)return void(a[r]=0);if(c<e)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])<e){s-=c+l,_=2;break}if(v>o){s-=c+l,_=7;break}return void(a[r]=0);case 8:if(c>o){if(v<e)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])<e)return void(a[r]=0);s-=c+l,_=9;break}if(c<e){if(l=v,(v=t[r+i[++d]])>o)return void(a[r]=0);s-=c+l,_=1;break}return void(a[r]=0);case 9:if(c<e){if(v>o)return void(a[r]=0);if(l=v,(v=t[r+i[++d]])>o)return void(a[r]=0);s-=c+l,_=8;break}if(c>o){if(l=v,(v=t[r+i[++d]])<e)return void(a[r]=0);s-=c+l,_=0;break}return void(a[r]=0)}a[r]=s+n*t[r]},e=function(t,r,a){this.dirs=new Int32Array(1024),this.dirs_count=0|function(t,r,a){var e,o,i=0;for(e=a,o=0;o<e;o++,i++)e=Math.sqrt(a*a-o*o)+.5|0,r[i]=e+t*o;for(e--;e<o&&e>=0;e--,i++)o=Math.sqrt(a*a-e*e)+.5|0,r[i]=e+t*o;for(;-e<o;e--,i++)o=Math.sqrt(a*a-e*e)+.5|0,r[i]=e+t*o;for(o--;o>=0;o--,i++)e=-Math.sqrt(a*a-o*o)-.5|0,r[i]=e+t*o;for(;o>e;o--,i++)e=-Math.sqrt(a*a-o*o)-.5|0,r[i]=e+t*o;for(e++;e<=0;e++,i++)o=-Math.sqrt(a*a-e*e)-.5|0,r[i]=e+t*o;for(;e<-o;e++,i++)o=-Math.sqrt(a*a-e*e)-.5|0,r[i]=e+t*o;for(o++;o<0;o++,i++)e=Math.sqrt(a*a-o*o)+.5|0,r[i]=e+t*o;return r[i]=r[0],r[i+1]=r[1],i}(t,this.dirs,a),this.scores=new Int32Array(t*r),this.radius=0|a},{level_tables:[],tau:7,init:function(t,r,a,o){var i;for(void 0===o&&(o=1),a=Math.min(a,7),a=Math.max(a,3),i=0;i<o;++i)this.level_tables[i]=new e(t>>i,r>>i,a)},detect:function(t,e,o){void 0===o&&(o=4);var i,f,n,s,h,d=this.level_tables[0],c=0|d.radius,u=c-1|0,l=d.dirs,v=0|d.dirs_count,_=v>>1,p=t.data,y=0|t.cols,x=0|t.rows,m=y>>1,w=d.scores,b=0,M=0,g=0,k=0,z=0,A=0,C=0,O=0,R=0|this.tau,S=0,L=0|Math.max(c+1,o),I=0|Math.max(c+1,o),U=0|Math.min(y-c-2,y-o),q=0|Math.min(x-c-2,x-o);for(g=I*y+L|0,M=I;M<q;++M,g+=y)for(b=L,k=g;b<U;++b,++k)z=p[k]+R,(A=p[k]-R)<p[k+c]&&p[k+c]<z&&A<p[k-c]&&p[k-c]<z?w[k]=0:a(p,k,w,A,z,l,_,v);for(g=I*y+L|0,M=I;M<q;++M,g+=y)for(b=L,k=g;b<U;++b,++k)O=w[k],(C=Math.abs(O))<5?(++b,++k):(s=y,h=void 0,h=0,0!=(f=w)[(n=k)+1]&&h++,0!=f[n-1]&&h++,0!=f[n+s]&&h++,0!=f[n+s+1]&&h++,0!=f[n+s-1]&&h++,0!=f[n-s]&&h++,0!=f[n-s+1]&&h++,0!=f[n-s-1]&&h++,h>=3&&r(w,k,O,m,c)&&((i=e[S]).x=b,i.y=M,i.score=C,++S,b+=u,k+=u));return S}});t.yape=o}(a),function(t){var r,e,o,i,f=(r=new Int32Array([8,-3,9,5,4,2,7,-12,-11,9,-8,2,7,-12,12,-13,2,-13,2,12,1,-7,1,6,-2,-10,-2,-4,-13,-13,-11,-8,-13,-3,-12,-9,10,4,11,9,-13,-8,-8,-9,-11,7,-9,12,7,7,12,6,-4,-5,-3,0,-13,2,-12,-3,-9,0,-7,5,12,-6,12,-1,-3,6,-2,12,-6,-13,-4,-8,11,-13,12,-8,4,7,5,1,5,-3,10,-3,3,-7,6,12,-8,-7,-6,-2,-2,11,-1,-10,-13,12,-8,10,-7,3,-5,-3,-4,2,-3,7,-10,-12,-6,11,5,-12,6,-7,5,-6,7,-1,1,0,4,-5,9,11,11,-13,4,7,4,12,2,-1,4,4,-4,-12,-2,7,-8,-5,-7,-10,4,11,9,12,0,-8,1,-13,-13,-2,-8,2,-3,-2,-2,3,-6,9,-4,-9,8,12,10,7,0,9,1,3,7,-5,11,-10,-13,-6,-11,0,10,7,12,1,-6,-3,-6,12,10,-9,12,-4,-13,8,-8,-12,-13,0,-8,-4,3,3,7,8,5,7,10,-7,-1,7,1,-12,3,-10,5,6,2,-4,3,-10,-13,0,-13,5,-13,-7,-12,12,-13,3,-11,8,-7,12,-4,7,6,-10,12,8,-9,-1,-7,-6,-2,-5,0,12,-12,5,-7,5,3,-10,8,-13,-7,-7,-4,5,-3,-2,-1,-7,2,9,5,-11,-11,-13,-5,-13,-1,6,0,-1,5,-3,5,2,-4,-13,-4,12,-9,-6,-9,6,-12,-10,-8,-4,10,2,12,-3,7,12,12,12,-7,-13,-6,5,-4,9,-3,4,7,-1,12,2,-7,6,-5,1,-13,11,-12,5,-3,7,-2,-6,7,-8,12,-7,-13,-7,-11,-12,1,-3,12,12,2,-6,3,0,-4,3,-2,-13,-1,-13,1,9,7,1,8,-6,1,-1,3,12,9,1,12,6,-1,-9,-1,3,-13,-13,-10,5,7,7,10,12,12,-5,12,9,6,3,7,11,5,-13,6,10,2,-12,2,3,3,8,4,-6,2,6,12,-13,9,-12,10,3,-8,4,-7,9,-11,12,-4,-6,1,12,2,-8,6,-9,7,-4,2,3,3,-2,6,3,11,0,3,-3,8,-8,7,8,9,3,-11,-5,-6,-4,-10,11,-5,10,-5,-8,-3,12,-10,5,-9,0,8,-1,12,-6,4,-6,6,-11,-10,12,-8,7,4,-2,6,7,-2,0,-2,12,-5,-8,-5,2,7,-6,10,12,-9,-13,-8,-8,-5,-13,-5,-2,8,-8,9,-13,-9,-11,-9,0,1,-8,1,-2,7,-4,9,1,-2,1,-1,-4,11,-6,12,-11,-12,-9,-6,4,3,7,7,12,5,5,10,8,0,-4,2,8,-9,12,-5,-13,0,7,2,12,-1,2,1,7,5,11,7,-9,3,5,6,-8,-13,-4,-8,9,-5,9,-3,-3,-4,-7,-3,-12,6,5,8,0,-7,6,-6,12,-13,6,-5,-2,1,-10,3,10,4,1,8,-4,-2,-2,2,-13,2,-12,12,12,-2,-13,0,-6,4,1,9,3,-6,-10,-3,-5,-3,-13,-1,1,7,5,12,-11,4,-2,5,-7,-13,9,-9,-5,7,1,8,6,7,-8,7,6,-7,-4,-7,1,-8,11,-7,-8,-13,6,-12,-8,2,4,3,9,10,-5,12,3,-6,-5,-6,7,8,-3,9,-8,2,-12,2,8,-11,-2,-10,3,-12,-13,-7,-9,-11,0,-10,-5,5,-3,11,8,-2,-13,-1,12,-1,-8,0,9,-13,-11,-12,-5,-10,-2,-10,11,-3,9,-2,-13,2,-3,3,2,-9,-13,-4,0,-4,6,-3,-10,-4,12,-2,-7,-6,-11,-4,9,6,-3,6,11,-13,11,-5,5,11,11,12,6,7,-5,12,-2,-1,12,0,7,-4,-8,-3,-2,-7,1,-6,7,-13,-12,-8,-13,-7,-2,-6,-8,-8,5,-6,-9,-5,-1,-4,5,-13,7,-8,10,1,5,5,-13,1,0,10,-13,9,12,10,-1,5,-8,10,-9,-1,11,1,-13,-9,-3,-6,2,-1,-10,1,12,-13,1,-8,-10,8,-11,10,-6,2,-13,3,-6,7,-13,12,-9,-10,-10,-5,-7,-10,-8,-8,-13,4,-6,8,5,3,12,8,-13,-4,2,-3,-3,5,-13,10,-12,4,-13,5,-1,-9,9,-4,3,0,3,3,-9,-12,1,-6,1,3,2,4,-8,-10,-10,-10,9,8,-13,12,12,-8,-12,-6,-5,2,2,3,7,10,6,11,-8,6,8,8,-12,-7,10,-6,5,-3,-9,-3,9,-1,-13,-1,5,-3,-7,-3,4,-8,-2,-8,3,4,2,12,12,2,-5,3,11,6,-9,11,-13,3,-1,7,12,11,-1,12,4,-3,0,-3,6,4,-11,4,12,2,-4,2,1,-10,-6,-8,1,-13,7,-11,1,-13,12,-11,-13,6,0,11,-13,0,-1,1,4,-13,3,-9,-2,-9,8,-6,-3,-13,-6,-8,-2,5,-9,8,10,2,7,3,-9,-1,-6,-1,-1,9,5,11,-2,11,-3,12,-8,3,0,3,5,-1,4,0,10,3,-6,4,5,-13,0,-10,5,5,8,12,11,8,9,9,-6,7,-4,8,-12,-10,4,-10,9,7,3,12,4,9,-7,10,-2,7,0,12,-2,-1,-6,0,-11]),e=new a.matrix_t(3,3,a.F32_t|a.C1_t),o=new a.matrix_t(32,32,a.U8_t|a.C1_t),i=function(t,r,a,o,i,f){var n=Math.cos(a),s=Math.sin(a);e.data[0]=n,e.data[1]=-s,e.data[2]=(-n+s)*f*.5+o,e.data[3]=s,e.data[4]=n,e.data[5]=(-s-n)*f*.5+i,v(t,r,e,128)},{describe:function(t,e,f,n){var s=0,h=0,d=0,c=0,u=0,l=0,v=0,_=0,p=o.data,y=0;n.type&a.U8_t?n.resize(32,f,1):(n.type=a.U8_t,n.cols=32,n.rows=f,n.channel=1,n.allocate());var x=n.data,m=0;for(s=0;s<f;++s){for(d=e[s].x,c=e[s].y,u=e[s].angle,i(t,o,u,d,c,32),y=0,h=0;h<32;++h)_=(l=p[528+32*r[y+1]+r[y]])<(v=p[528+32*r[(y+=2)+1]+r[y]])|0,_|=((l=p[528+32*r[(y+=2)+1]+r[y]])<(v=p[528+32*r[(y+=2)+1]+r[y]]))<<1,_|=((l=p[528+32*r[(y+=2)+1]+r[y]])<(v=p[528+32*r[(y+=2)+1]+r[y]]))<<2,_|=((l=p[528+32*r[(y+=2)+1]+r[y]])<(v=p[528+32*r[(y+=2)+1]+r[y]]))<<3,_|=((l=p[528+32*r[(y+=2)+1]+r[y]])<(v=p[528+32*r[(y+=2)+1]+r[y]]))<<4,_|=((l=p[528+32*r[(y+=2)+1]+r[y]])<(v=p[528+32*r[(y+=2)+1]+r[y]]))<<5,_|=((l=p[528+32*r[(y+=2)+1]+r[y]])<(v=p[528+32*r[(y+=2)+1]+r[y]]))<<6,l=p[528+32*r[(y+=2)+1]+r[y]],v=p[528+32*r[(y+=2)+1]+r[y]],y+=2,_|=(l<v)<<7,x[m+h]=_;m+=32}}});t.orb=f}(a);var D=Object.freeze({__proto__:null,track:function(t,r,e,f,n,s,h,d,c,l){void 0===h&&(h=30),void 0===d&&(d=new Uint8Array(n)),void 0===c&&(c=.01),void 0===l&&(l=1e-4);var v=.5*(s-1),_=s*s|0,p=_<<1,y=t.data,x=r.data,m=y[0].data,w=x[0].data,b=y[0].cols,M=y[0].rows,g=0,k=0,z=o(_<<2),A=o(p<<2),C=o(M*(b<<1)<<2),O=new a.matrix_t(b,M,a.S32C2_t,C.data),R=z.i32,S=A.i32,L=C.i32,I=0,U=0,q=0,G=0,F=0,B=0,N=0,E=0,P=0,V=0,j=0,T=0,Y=0,D=0,Q=0,X=0,H=0,J=0,K=0,W=0,Z=0,$=0,tt=0,rt=0,at=0,et=0,ot=0,it=0,ft=0,nt=0,st=0,ht=0,dt=0,ct=0,ut=0,lt=0,vt=0,_t=0,pt=0,yt=0,xt=0,mt=0,wt=0;for(c*=c;W<n;++W)d[W]=1;var bt=t.levels-1|0;for(rt=bt;rt>=0;--rt)for(N=1/(1<<rt),k=M>>rt,I=(g=b>>rt)<<1,m=y[rt].data,w=x[rt].data,ot=g-s|0,it=k-s|0,u(y[rt],O),at=0;at<n;++at)if(Z=(W=at<<1)+1,E=e[W]*N,P=e[Z]*N,rt==bt?(V=E,j=P):(V=2*f[W],j=2*f[Z]),f[W]=V,f[Z]=j,0==($=(X=0|(E-=v))<=0|X>=ot|(H=0|(P-=v))<=0|H>=it)){for(lt=16384-(dt=(1-(ft=E-X))*(1-(nt=P-H))*16384+.5|0)-(ct=ft*(1-nt)*16384+.5|0)-(ut=(1-ft)*nt*16384+.5|0),yt=0,xt=0,mt=0,tt=0;tt<s;++tt)for(q=(U=(tt+H)*g+X|0)<<1,F=(G=tt*s|0)<<1,$=0;$<s;++$,++U,++G,q+=2)vt=(vt=m[U]*dt+m[U+1]*ct+m[U+g]*ut+m[U+g+1]*lt)+256>>9,_t=(_t=L[q]*dt+L[q+2]*ct+L[q+I]*ut+L[q+I+2]*lt)+8192>>14,pt=(pt=L[q+1]*dt+L[q+3]*ct+L[q+I+1]*ut+L[q+I+3]*lt)+8192>>14,R[G]=vt,S[F++]=_t,S[F++]=pt,yt+=_t*_t,xt+=_t*pt,mt+=pt*pt;if(wt=(yt*=1/(1<<20))*(mt*=1/(1<<20))-(xt*=1/(1<<20))*xt,(mt+yt-Math.sqrt((yt-mt)*(yt-mt)+4*xt*xt))/p<l||wt<1.1920929e-7)0==rt&&(d[at]=0);else for(wt=1/wt,V-=v,j-=v,T=0,Y=0,et=0;et<h;++et){if(0!=($=(J=0|V)<=0|J>=ot|(K=0|j)<=0|K>=it)){0==rt&&(d[at]=0);break}for(lt=16384-(dt=(1-(ft=V-J))*(1-(nt=j-K))*16384+.5|0)-(ct=ft*(1-nt)*16384+.5|0)-(ut=(1-ft)*nt*16384+.5|0),st=0,ht=0,tt=0;tt<s;++tt)for(B=(tt+K)*g+J|0,F=(G=tt*s|0)<<1,$=0;$<s;++$,++B,++G)vt=(vt=w[B]*dt+w[B+1]*ct+w[B+g]*ut+w[B+g+1]*lt)+256>>9,st+=(vt-=R[G])*S[F++],ht+=vt*S[F++];if(V+=D=(xt*(ht*=1/(1<<20))-mt*(st*=1/(1<<20)))*wt,j+=Q=(xt*st-yt*ht)*wt,f[W]=V+v,f[Z]=j+v,D*D+Q*Q<=c)break;if(et>0&&Math.abs(D+T)<.01&&Math.abs(Q+Y)<.01){f[W]-=.5*D,f[Z]-=.5*Q;break}T=D,Y=Q}}else 0==rt&&(d[at]=0);i(z),i(A),i(C)}}),Q=function(t,r){var a=.25*t.width+.5|0;return r.x<=t.x+a&&r.x>=t.x-a&&r.y<=t.y+a&&r.y>=t.y-a&&r.width<=1.5*t.width+.5|0&&1.5*r.width+.5|0>=t.width};const X=function(t,r,a,e,o,i,f,n){var s,h,d,c,u,l,v,_,p,y,x,m,w,b,M,g,k,z,A,C,O,R,S,L,I,U=n.size[0]*f|0,q=n.size[1]*f|0,G=.5*f+1.5|0,F=G,B=o-U|0,N=i-q|0,E=o+1|0,P=1/(U*q),V=!0,j=0,T=U,Y=q*E,D=Y+U,Q=U*q*255*.07|0,X=[];for(u=0;u<N;u+=F)for(j=u*E,c=0;c<B;c+=G,j+=G)if(l=t[j]-t[j+T]-t[j+Y]+t[j+D],e&&(e[j]-e[j+T]-e[j+Y]+e[j+D]<Q||l<20))c+=G,j+=G;else{for(l*=P,_=(v=(r[j]-r[j+T]-r[j+Y]+r[j+D])*P-l*l)>0?Math.sqrt(v):1,w=(p=n.complexClassifiers).length,V=!0,s=0;s<w;++s){for(g=(y=p[s]).threshold,b=(x=y.simpleClassifiers).length,k=0,h=0;h<b;++h){if(z=0,M=(C=(m=x[h]).features).length,1===m.tilted)for(d=0;d<M;++d)O=~~(c+(A=C[d])[0]*f)+~~(u+A[1]*f)*E,R=(L=~~(A[2]*f))*E,S=(I=~~(A[3]*f))*E,z+=(a[O]-a[O+L+R]-a[O-I+S]+a[O+L-I+R+S])*A[4];else for(d=0;d<M;++d)O=~~(c+(A=C[d])[0]*f)+~~(u+A[1]*f)*E,L=~~(A[2]*f),S=(I=~~(A[3]*f))*E,z+=(t[O]-t[O+L]-t[O+S]+t[O+S+L])*A[4];k+=z*P<m.threshold*_?m.left_val:m.right_val}if(k<g){V=!1;break}}V&&(X.push({x:c,y:u,width:U,height:q,neighbor:1,confidence:k}),c+=G,j+=G)}return X};var H=Object.freeze({__proto__:null,edges_density:.07,detect_single_scale:X,detect_multi_scale:function(t,r,a,e,o,i,f,n,s){void 0===n&&(n=1.2),void 0===s&&(s=1);for(var h=f.size[0],d=f.size[1],c=[];s*h<o&&s*d<i;)c=c.concat(X(t,r,a,e,o,i,s,f)),s*=n;return c},group_rectangles:function(t,r){void 0===r&&(r=1);var a,e,o=t.length,i=[];for(a=0;a<o;++a)i[a]={parent:-1,element:t[a],rank:0};for(a=0;a<o;++a)if(i[a].element){for(var f=a;-1!=i[f].parent;)f=i[f].parent;for(e=0;e<o;++e)if(a!=e&&i[e].element&&Q(i[a].element,i[e].element)){for(var n=e;-1!=i[n].parent;)n=i[n].parent;if(n!=f){i[f].rank>i[n].rank?i[n].parent=f:(i[f].parent=n,i[f].rank==i[n].rank&&i[n].rank++,f=n);for(var s,h=e;-1!=i[h].parent;)s=h,h=i[h].parent,i[s].parent=f;for(h=a;-1!=i[h].parent;)s=h,h=i[h].parent,i[s].parent=f}}}var d=[],c=0;for(a=0;a<o;a++){e=-1;var u=a;if(i[u].element){for(;-1!=i[u].parent;)u=i[u].parent;i[u].rank>=0&&(i[u].rank=~c++),e=~i[u].rank}d[a]=e}var l=[];for(a=0;a<c+1;++a)l[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(a=0;a<o;++a){let r=t[a];var v=d[a];0==l[v].neighbors&&(l[v].confidence=r.confidence),++l[v].neighbors,l[v].x+=r.x,l[v].y+=r.y,l[v].width+=r.width,l[v].height+=r.height,l[v].confidence=Math.max(l[v].confidence,r.confidence)}var _=[];for(a=0;a<c;++a)(o=l[a].neighbors)>=r&&_.push({x:(2*l[a].x+o)/(2*o),y:(2*l[a].y+o)/(2*o),width:(2*l[a].width+o)/(2*o),height:(2*l[a].height+o)/(2*o),neighbors:l[a].neighbors,confidence:l[a].confidence});var p=[];for(o=_.length,a=0;a<o;++a){let t=_[a];var y=!0;for(e=0;e<o;++e){var x=_[e],m=.25*x.width+.5|0;if(a!=e&&t.x>=x.x-m&&t.y>=x.y-m&&t.x+t.width<=x.x+x.width+m&&t.y+t.height<=x.y+x.height+m&&(x.neighbors>Math.max(3,t.neighbors)||t.neighbors<3)){y=!1;break}}y&&p.push(t)}return p}}),J=function(t,r){var a=.25*t.width+.5|0;return r.x<=t.x+a&&r.x>=t.x-a&&r.y<=t.y+a&&r.y>=t.y-a&&r.width<=1.5*t.width+.5|0&&1.5*r.width+.5|0>=t.width},K=new a.pyramid_t(1);let W=4,Z=1.1486,$=5,tt=1;var rt=Object.freeze({__proto__:null,get interval(){return W},get scale(){return Z},get next(){return $},get scale_to(){return tt},prepare_cascade:function(t){for(var r=t.stage_classifier.length,a=0;a<r;a++)for(var e=t.stage_classifier[a].feature,o=t.stage_classifier[a].count,i=t.stage_classifier[a]._feature=new Array(o),f=0;f<o;f++)i[f]={size:e[f].size,px:new Array(e[f].size),pz:new Array(e[f].size),nx:new Array(e[f].size),nz:new Array(e[f].size)}},build_pyramid:function(t,r,e,o){void 0===o&&(o=4);var i=t.cols,f=t.rows,n=0,s=0,h=0,u=!1,l=t,v=t,_=a.U8_t|a.C1_t;W=o,Z=Math.pow(2,1/(W+1)),$=W+1|0,tt=Math.log(Math.min(i/r,f/e))/Math.log(Z)|0;var p=4*(tt+2*$)|0;for(K.levels!=p&&(K.levels=p,K.data=new Array(p),u=!0,K.data[0]=t),n=1;n<=W;++n)s=i/Math.pow(Z,n)|0,h=f/Math.pow(Z,n)|0,l=K.data[n<<2],(u||s!=l.cols||h!=l.rows)&&(K.data[n<<2]=new a.matrix_t(s,h,_),l=K.data[n<<2]),d(t,l,s,h);for(n=$;n<tt+2*$;++n)v=K.data[(n<<2)-($<<2)],l=K.data[n<<2],s=v.cols>>1,h=v.rows>>1,(u||s!=l.cols||h!=l.rows)&&(K.data[n<<2]=new a.matrix_t(s,h,_),l=K.data[n<<2]),c(v,l);for(n=2*$;n<tt+2*$;++n)s=(v=K.data[(n<<2)-($<<2)]).cols>>1,h=v.rows>>1,l=K.data[1+(n<<2)],(u||s!=l.cols||h!=l.rows)&&(K.data[1+(n<<2)]=new a.matrix_t(s,h,_),l=K.data[1+(n<<2)]),c(v,l,1,0),l=K.data[2+(n<<2)],(u||s!=l.cols||h!=l.rows)&&(K.data[2+(n<<2)]=new a.matrix_t(s,h,_),l=K.data[2+(n<<2)]),c(v,l,0,1),l=K.data[3+(n<<2)],(u||s!=l.cols||h!=l.rows)&&(K.data[3+(n<<2)]=new a.matrix_t(s,h,_),l=K.data[3+(n<<2)]),c(v,l,1,1);return K},detect:function(t,r){var a,e,o,i,f,n=0,s=0,h=0,d=0,c=0,u=0,l=0,v=0,_=0,p=0,y=0,x=0,m=0,w=0,b=0,M=0,g=0,k=0,z=!0,A=!0,C=1,O=1,R=[0,1,0,1],S=[0,0,1,1],L=[],I=t.data,U=[],q=[0,0,0],G=[0,0,0],F=[0,0,0];for(n=0;n<tt;n++){for(M=I[(b=n<<2)+($<<3)].cols-(r.width>>2),g=I[b+($<<3)].rows-(r.height>>2),G[0]=1*I[b].cols,G[1]=1*I[b+($<<2)].cols,G[2]=1*I[b+($<<3)].cols,F[0]=4*I[b].cols-4*M,F[1]=2*I[b+($<<2)].cols-2*M,F[2]=1*I[b+($<<3)].cols-1*M,v=r.stage_classifier.length,s=0;s<v;s++)for(o=r.stage_classifier[s].feature,e=r.stage_classifier[s]._feature,_=r.stage_classifier[s].count,h=0;h<_;h++)for(i=e[h],p=0|(f=o[h]).size,l=0;l<p;l++)i.px[l]=1*f.px[l]+f.py[l]*G[f.pz[l]],i.pz[l]=f.pz[l],i.nx[l]=1*f.nx[l]+f.ny[l]*G[f.nz[l]],i.nz[l]=f.nz[l];for(U[0]=I[b].data,U[1]=I[b+($<<2)].data,l=0;l<4;l++)for(U[2]=I[b+($<<3)+l].data,q[0]=2*R[l]+S[l]*(2*I[b].cols),q[1]=1*R[l]+S[l]*(1*I[b+($<<2)].cols),q[2]=0,u=0;u<g;u++){for(c=0;c<M;c++){for(k=0,z=!0,v=r.stage_classifier.length,s=0;s<v;s++){for(k=0,a=r.stage_classifier[s].alpha,e=r.stage_classifier[s]._feature,_=r.stage_classifier[s].count,h=0;h<_;h++)if((x=U[(i=e[h]).pz[0]][q[i.pz[0]]+i.px[0]])<=(m=U[i.nz[0]][q[i.nz[0]]+i.nx[0]]))k+=a[h<<1];else{for(A=!0,p=i.size,w=1;w<p;w++){if(i.pz[w]>=0&&(y=U[i.pz[w]][q[i.pz[w]]+i.px[w]])<x){if(y<=m){A=!1;break}x=y}if(i.nz[w]>=0&&(d=U[i.nz[w]][q[i.nz[w]]+i.nx[w]])>m){if(x<=d){A=!1;break}m=d}}k+=A?a[1+(h<<1)]:a[h<<1]}if(k<r.stage_classifier[s].threshold){z=!1;break}}z&&(L.push({x:(4*c+2*R[l])*C,y:(4*u+2*S[l])*O,width:r.width*C,height:r.height*O,neighbor:1,confidence:k}),++c,q[0]+=4,q[1]+=2,q[2]+=1),q[0]+=4,q[1]+=2,q[2]+=1}q[0]+=F[0],q[1]+=F[1],q[2]+=F[2]}C*=Z,O*=Z}return L},group_rectangles:function(t,r){void 0===r&&(r=1);var a,e,o=t.length,i=[];for(a=0;a<o;++a)i[a]={parent:-1,element:t[a],rank:0};for(a=0;a<o;++a)if(i[a].element){for(var f=a;-1!=i[f].parent;)f=i[f].parent;for(e=0;e<o;++e)if(a!=e&&i[e].element&&J(i[a].element,i[e].element)){for(var n=e;-1!=i[n].parent;)n=i[n].parent;if(n!=f){i[f].rank>i[n].rank?i[n].parent=f:(i[f].parent=n,i[f].rank==i[n].rank&&i[n].rank++,f=n);for(var s,h=e;-1!=i[h].parent;)s=h,h=i[h].parent,i[s].parent=f;for(h=a;-1!=i[h].parent;)s=h,h=i[h].parent,i[s].parent=f}}}var d=[],c=0;for(a=0;a<o;a++){e=-1;var u=a;if(i[u].element){for(;-1!=i[u].parent;)u=i[u].parent;i[u].rank>=0&&(i[u].rank=~c++),e=~i[u].rank}d[a]=e}var l=[];for(a=0;a<c+1;++a)l[a]={neighbors:0,x:0,y:0,width:0,height:0,confidence:0};for(a=0;a<o;++a){let r=t[a];var v=d[a];0==l[v].neighbors&&(l[v].confidence=r.confidence),++l[v].neighbors,l[v].x+=r.x,l[v].y+=r.y,l[v].width+=r.width,l[v].height+=r.height,l[v].confidence=Math.max(l[v].confidence,r.confidence)}var _=[];for(a=0;a<c;++a)(o=l[a].neighbors)>=r&&_.push({x:(2*l[a].x+o)/(2*o),y:(2*l[a].y+o)/(2*o),width:(2*l[a].width+o)/(2*o),height:(2*l[a].height+o)/(2*o),neighbors:l[a].neighbors,confidence:l[a].confidence});var p=[];for(o=_.length,a=0;a<o;++a){let t=_[a];var y=!0;for(e=0;e<o;++e){var x=_[e],m=.25*x.width+.5|0;if(a!=e&&t.x>=x.x-m&&t.y>=x.y-m&&t.x+t.width<=x.x+x.width+m&&t.y+t.height<=x.y+x.height+m&&(x.neighbors>Math.max(3,t.neighbors)||t.neighbors<3)){y=!1;break}}y&&p.push(t)}return p}});return a.math=h,a.matmath=L,a.linalg=F,a.imgproc=k,a.fast_corners=Y,a.optical_flow_lk=D,a.haar=H,a.bbf=rt,a}));
